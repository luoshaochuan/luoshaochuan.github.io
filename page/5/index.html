
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
  
    <title>我是小韩同学</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="洛绍川">
    

    
    <meta name="description" content="code">
<meta property="og:type" content="website">
<meta property="og:title" content="我是小韩同学">
<meta property="og:url" content="http://www.luoshaochuan.com/page/5/index.html">
<meta property="og:site_name" content="我是小韩同学">
<meta property="og:description" content="code">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="我是小韩同学">
<meta name="twitter:description" content="code">

    
    
    
    <link rel="stylesheet" href="/css/style.css"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

  <body>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="我是小韩同学" title="我是小韩同学"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="我是小韩同学">我是小韩同学</a></h1>
				<h2 class="blog-motto"></h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
						<li><a href="/tags">标签</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:www.luoshaochuan.com">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main">

   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/09/07/二叉树/" title="二叉树" itemprop="url">二叉树</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2017-09-07T12:00:00.000Z" itemprop="datePublished"> 发表于 2017-09-07</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="二叉树"><a href="#二叉树" class="headerlink" title="二叉树"></a>二叉树</h3><h3 id="1-建立二叉树"><a href="#1-建立二叉树" class="headerlink" title="1.建立二叉树"></a>1.建立二叉树</h3><p>给定前序中序和后序中序遍历可以唯一的确定一棵二叉树。<br><a href="https://leetcode.com/problems/construct-binary-tree-from-preorder-and-inorder-traversal/description/" target="_blank" rel="external">105. Construct Binary Tree from Preorder and Inorder Traversal</a><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">class</span> Solution &#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    </div><div class="line">    <span class="function">TreeNode* <span class="title">build</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; preorder, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; inorder,<span class="keyword">int</span> pre_left,<span class="keyword">int</span> in_left,<span class="keyword">int</span> length)</span></span></div><div class="line">    &#123;</div><div class="line">        TreeNode* root=<span class="literal">NULL</span>;</div><div class="line">        <span class="keyword">if</span>(length&gt;<span class="number">0</span>)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">int</span> pos=in_left;</div><div class="line">            <span class="keyword">while</span>(pos-in_left&lt;length&amp;&amp;inorder[pos]!=preorder[pre_left])++pos;</div><div class="line">            root=<span class="keyword">new</span> TreeNode(inorder[pos]);</div><div class="line">            root-&gt;left=build(preorder,inorder,pre_left+<span class="number">1</span>,in_left,pos-in_left);</div><div class="line">            root-&gt;right=build(preorder,inorder,pre_left+pos-in_left+<span class="number">1</span>,pos+<span class="number">1</span>,length-(pos-in_left)<span class="number">-1</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> root;</div><div class="line">    &#125;</div><div class="line">    <span class="function">TreeNode* <span class="title">buildTree</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; preorder, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; inorder)</span> </span>&#123;</div><div class="line">        TreeNode* root=build(preorder,inorder,<span class="number">0</span>,<span class="number">0</span>,inorder.size());</div><div class="line">        <span class="keyword">return</span> root;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p><a href="https://leetcode.com/problems/construct-binary-tree-from-inorder-and-postorder-traversal/description/" target="_blank" rel="external">106. Construct Binary Tree from Inorder and Postorder Traversal
</a><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">class</span> Solution &#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function">TreeNode* <span class="title">build</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; inorder, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; postorder,<span class="keyword">int</span> in_left,<span class="keyword">int</span> post_left,<span class="keyword">int</span> length)</span></span></div><div class="line">    &#123;</div><div class="line">        TreeNode* root=<span class="literal">NULL</span>;</div><div class="line">        <span class="keyword">if</span>(length&gt;<span class="number">0</span>)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">int</span> pos=in_left;</div><div class="line">            <span class="keyword">while</span>(pos-in_left&lt;length&amp;&amp;inorder[pos]!=postorder[post_left+length<span class="number">-1</span>])++pos;</div><div class="line">            root=<span class="keyword">new</span> TreeNode(inorder[pos]);</div><div class="line">            root-&gt;left=build(inorder,postorder,in_left,post_left,pos-in_left);</div><div class="line">            root-&gt;right=build(inorder,postorder,pos+<span class="number">1</span>,post_left+pos-in_left,length-(pos-in_left)<span class="number">-1</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> root;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function">TreeNode* <span class="title">buildTree</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; inorder, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; postorder)</span> </span>&#123;</div><div class="line">        TreeNode*root=build(inorder,postorder,<span class="number">0</span>,<span class="number">0</span>,inorder.size());</div><div class="line">        <span class="keyword">return</span> root;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<h3 id="2-遍历二叉树"><a href="#2-遍历二叉树" class="headerlink" title="2.遍历二叉树"></a>2.遍历二叉树</h3><h4 id="非递归遍历"><a href="#非递归遍历" class="headerlink" title="非递归遍历"></a>非递归遍历</h4><p>前序：<a href="https://leetcode.com/problems/binary-tree-preorder-traversal/description/" target="_blank" rel="external">144. Binary Tree Preorder Traversal</a><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">class</span> Solution &#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; preorderTraversal(TreeNode* root) &#123;</div><div class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; res;</div><div class="line">        <span class="built_in">stack</span>&lt;TreeNode*&gt; st;</div><div class="line">        <span class="keyword">while</span>(root || !st.empty())</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">while</span>(root)</div><div class="line">            &#123;</div><div class="line">                res.push_back(root-&gt;val);</div><div class="line">                st.push(root);</div><div class="line">                root=root-&gt;left;</div><div class="line">            &#125;</div><div class="line">            root=st.top();</div><div class="line">            root=root-&gt;right;</div><div class="line">            st.pop();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> res;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>中序：<a href="https://leetcode.com/problems/binary-tree-inorder-traversal/description/" target="_blank" rel="external">94. Binary Tree Inorder Traversal</a><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">class</span> Solution &#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; inorderTraversal(TreeNode* root) &#123;</div><div class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; res;</div><div class="line">        <span class="built_in">stack</span>&lt;TreeNode*&gt; st;</div><div class="line">        <span class="keyword">while</span>(root||!st.empty())</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">while</span>(root)</div><div class="line">            &#123;</div><div class="line">                st.push(root);</div><div class="line">                root=root-&gt;left;</div><div class="line">            &#125;</div><div class="line">            root=st.top();</div><div class="line">            res.push_back(root-&gt;val);</div><div class="line">            st.pop();</div><div class="line">            root=root-&gt;right;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> res;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>后序:<a href="https://leetcode.com/problems/binary-tree-postorder-traversal/description/" target="_blank" rel="external">145. Binary Tree Postorder Traversal</a><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">class</span> Solution &#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; postorderTraversal(TreeNode* root) &#123;</div><div class="line">        <span class="comment">//模拟递归过程，关键是判断左子树和右子树是否已经遍历完,即出栈的是不是当前元素的左节点或者右节点</span></div><div class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; res;</div><div class="line">        <span class="built_in">stack</span>&lt;TreeNode*&gt; st;</div><div class="line">        TreeNode *pre=<span class="literal">NULL</span>,*cur=root;</div><div class="line">        <span class="keyword">while</span>(cur||!st.empty())</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">while</span>(cur)</div><div class="line">            &#123;</div><div class="line">                st.push(cur);</div><div class="line">                cur=cur-&gt;left;</div><div class="line">            &#125;</div><div class="line">            cur=st.top();</div><div class="line">            <span class="keyword">if</span>(cur-&gt;right&amp;&amp;cur-&gt;right!=pre)</div><div class="line">                cur=cur-&gt;right;</div><div class="line">            <span class="keyword">else</span></div><div class="line">            &#123;</div><div class="line">                res.push_back(cur-&gt;val);</div><div class="line">                st.pop();</div><div class="line">                pre=cur;</div><div class="line">                cur=<span class="literal">NULL</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;     </div><div class="line">        <span class="keyword">return</span> res;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<h4 id="Morris遍历"><a href="#Morris遍历" class="headerlink" title="Morris遍历"></a>Morris遍历</h4><p>中序：<a href="https://leetcode.com/problems/binary-tree-inorder-traversal/description/" target="_blank" rel="external">94. Binary Tree Inorder Traversal</a><br>核心思想是利用当前节点左子树的最右节点的右指针指向当前节点。之所以要找当前节点左子树的最右节点，是因为该节点是当前节点中序遍历的前驱节点。<br><strong>步骤：</strong></p>
<ol>
<li><p>如果当前节点的左孩子为空，则输出当前节点并将其右孩子作为当前节点。</p>
</li>
<li><p>如果当前节点的左孩子不为空，在当前节点的左子树中找到当前节点在中序遍历下的前驱节点。</p>
<p>a) 如果前驱节点的右孩子为空，将它的右孩子设置为当前节点。当前节点更新为当前节点的左孩子。</p>
<p>b) 如果前驱节点的右孩子为当前节点，将它的右孩子重新设为空（恢复树的形状）。输出当前节点。当前节点更新为当前节点的右孩子。</p>
</li>
<li><p>重复以上1、2直到当前节点为空。</p>
</li>
</ol>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">算法伪码：</div><div class="line"></div><div class="line"><span class="function"><span class="title">MorrisInOrder</span><span class="params">()</span></span>：</div><div class="line">while 没有结束</div><div class="line">   如果当前节点没有左后代</div><div class="line">     访问该节点</div><div class="line">     转向右节点</div><div class="line">   否则</div><div class="line">     找到左后代的最右节点，且使最右节点的右指针指向当前节点，转向左后代节点。</div><div class="line">     如果右指针已经指向当前节点，则将其置为空，转向右子树节点。</div></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">class</span> Solution &#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; inorderTraversal(TreeNode* root) &#123;</div><div class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; res;</div><div class="line">        TreeNode *cur=root,*pre=<span class="literal">NULL</span>;</div><div class="line">        <span class="keyword">while</span>(cur)</div><div class="line">        &#123;</div><div class="line">            <span class="comment">/*左节点为空，输出当前节点，转向其右节点*/</span></div><div class="line">            <span class="keyword">if</span>(cur-&gt;left==<span class="literal">NULL</span>)</div><div class="line">            &#123;</div><div class="line">                res.push_back(cur-&gt;val);</div><div class="line">                cur=cur-&gt;right;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span></div><div class="line">            &#123;</div><div class="line">                pre=cur-&gt;left;</div><div class="line">                <span class="keyword">while</span>(pre-&gt;right&amp;&amp;pre-&gt;right!=cur)pre=pre-&gt;right;</div><div class="line">                <span class="keyword">if</span>(pre-&gt;right==<span class="literal">NULL</span>)</div><div class="line">                &#123;</div><div class="line">                    pre-&gt;right=cur;</div><div class="line">                    cur=cur-&gt;left;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">else</span></div><div class="line">                &#123;</div><div class="line">                    pre-&gt;right=<span class="literal">NULL</span>;</div><div class="line">                    res.push_back(cur-&gt;val);</div><div class="line">                    cur=cur-&gt;right;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> res;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>前序：<a href="https://leetcode.com/problems/binary-tree-preorder-traversal/description/" target="_blank" rel="external">144. Binary Tree Preorder Traversal</a><br>关键还是找前序遍历的前驱结点。前序遍历是根左右，所以根的右节点的前驱节点为左子树的最右节点。<br><strong>步骤：</strong></p>
<ol>
<li><p>如果当前节点的左孩子为空，则输出当前节点并将其右孩子作为当前节点。</p>
</li>
<li><p>如果当前节点的左孩子不为空，在当前节点的左子树中找到当前节点在中序遍历下的前驱节点。</p>
<p>a) 如果前驱节点的右孩子为空，将它的右孩子设置为当前节点。输出当前节点（在这里输出，这是与中序遍历唯一一点不同）。当前节点更新为当前节点的左孩子。</p>
<p>b) 如果前驱节点的右孩子为当前节点，将它的右孩子重新设为空。当前节点更新为当前节点的右孩子。</p>
</li>
<li><p>重复以上1、2直到当前节点为空。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * Definition for a binary tree node.</div><div class="line"> * struct TreeNode &#123;</div><div class="line"> *     int val;</div><div class="line"> *     TreeNode *left;</div><div class="line"> *     TreeNode *right;</div><div class="line"> *     TreeNode(int x) : val(x), left(NULL), right(NULL) &#123;&#125;</div><div class="line"> * &#125;;</div><div class="line"> */</div><div class="line"><span class="keyword">class</span> Solution &#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; preorderTraversal(TreeNode* root) &#123;</div><div class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; res;</div><div class="line">        TreeNode *cur=root,*pre=<span class="literal">NULL</span>;</div><div class="line">        <span class="keyword">while</span>(cur)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">if</span>(cur-&gt;left==<span class="literal">NULL</span>)</div><div class="line">            &#123;</div><div class="line">                res.push_back(cur-&gt;val);</div><div class="line">                cur=cur-&gt;right; </div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span></div><div class="line">            &#123;</div><div class="line">                pre=cur-&gt;left;</div><div class="line">                <span class="keyword">while</span>(pre-&gt;right&amp;&amp;pre-&gt;right!=cur)pre=pre-&gt;right;</div><div class="line">                <span class="keyword">if</span>(pre-&gt;right==<span class="literal">NULL</span>)</div><div class="line">                &#123;</div><div class="line">                    res.push_back(cur-&gt;val);<span class="comment">//进入左子树前</span></div><div class="line">                    pre-&gt;right=cur;</div><div class="line">                    cur=cur-&gt;left;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">else</span></div><div class="line">                &#123;</div><div class="line">                    pre-&gt;right=<span class="literal">NULL</span>;</div><div class="line">                    cur=cur-&gt;right;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> res;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>后序：<a href="https://leetcode.com/problems/binary-tree-postorder-traversal/description/" target="_blank" rel="external">145. Binary Tree Postorder Traversal</a><br>后续遍历稍显复杂，需要建立一个临时节点dump，令其左孩子是root。并且还需要一个子过程，就是倒序输出某两个节点之间路径上的各个节点。</p>
<p><strong>步骤：</strong></p>
<p>当前节点设置为临时节点dummy。</p>
<ol>
<li><p>如果当前节点的左孩子为空，则将其右孩子作为当前节点。</p>
</li>
<li><p>如果当前节点的左孩子不为空，在当前节点的左子树中找到当前节点在中序遍历下的前驱节点。</p>
<p>a) 如果前驱节点的右孩子为空，将它的右孩子设置为当前节点。当前节点更新为当前节点的左孩子。</p>
<p>b) 如果前驱节点的右孩子为当前节点，将它的右孩子重新设为空。倒序输出从当前节点的左孩子到该前驱节点这条路径上的所有节点。当前节点更新为当前节点的右孩子。</p>
</li>
<li><p>重复以上1、2直到当前节点为空。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">class</span> Solution &#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; res;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">reverse</span><span class="params">(TreeNode *from,TreeNode *to)</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span>(from==to)<span class="keyword">return</span>;</div><div class="line">        TreeNode *p=from,*q=from-&gt;right;</div><div class="line">        <span class="keyword">while</span>(p!=to)</div><div class="line">        &#123;</div><div class="line">            TreeNode* temp=q-&gt;right;</div><div class="line">            q-&gt;right=p;</div><div class="line">            p=q;</div><div class="line">            q=temp;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print_reverse</span><span class="params">(TreeNode *from,TreeNode *to)</span></span></div><div class="line">    &#123;</div><div class="line">        reverse(from,to);</div><div class="line">        TreeNode *p = to;</div><div class="line">        <span class="keyword">while</span>(p!=from)&#123;</div><div class="line">            res.push_back(p-&gt;val);</div><div class="line">            p=p-&gt;right;</div><div class="line">        &#125;</div><div class="line">        res.push_back(p-&gt;val);</div><div class="line">        reverse(to,from);</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; postorderTraversal(TreeNode* root) </div><div class="line">    &#123;</div><div class="line">        <span class="function">TreeNode <span class="title">dummy</span><span class="params">(<span class="number">0</span>)</span></span>;</div><div class="line">        dummy.left=root;</div><div class="line">        TreeNode *cur=&amp;dummy,*pre=<span class="literal">NULL</span>;</div><div class="line">        <span class="keyword">while</span>(cur)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">if</span>(cur-&gt;left==<span class="literal">NULL</span>)</div><div class="line">            &#123;</div><div class="line">                cur=cur-&gt;right;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span></div><div class="line">            &#123;</div><div class="line">                pre=cur-&gt;left;</div><div class="line">                <span class="keyword">while</span>(pre-&gt;right&amp;&amp;pre-&gt;right!=cur)pre=pre-&gt;right;</div><div class="line">                <span class="keyword">if</span>(pre-&gt;right==<span class="literal">NULL</span>)</div><div class="line">                &#123;</div><div class="line">                    pre-&gt;right=cur;</div><div class="line">                    cur=cur-&gt;left;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">else</span></div><div class="line">                &#123;</div><div class="line">                    </div><div class="line">                    print_reverse(cur-&gt;left,pre);</div><div class="line">                    pre-&gt;right=<span class="literal">NULL</span>;</div><div class="line">                    cur=cur-&gt;right;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> res;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
</ol>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/二叉树/">二叉树</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/08/31/hihocoder1141/" title="区间逆序对" itemprop="url">区间逆序对</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2017-08-31T14:49:40.000Z" itemprop="datePublished"> 发表于 2017-08-31</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="二分·归并排序之逆序对"><a href="#二分·归并排序之逆序对" class="headerlink" title=" 二分·归并排序之逆序对"></a><a href="http://hihocoder.com/problemset/problem/1141" target="_blank" rel="external"> 二分·归并排序之逆序对</a></h3><h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>元素值较小时可以采用树状数组，否则采用归并排序。<br>假设有个数组{4,3,2,1}那么我们二分数组得到{4,3},{2,1}两个子数组。对{4,3}继续二分得到两个子数组a{4},b{3}现在我们将两个进行归并为c。b的第一个元素3小于4，先把3放进c,再把a中的4放进c。可以看出每次把a中元素放入c时,c中属于b的元素都和此元素构成逆序对，所以我们只需要统计c中属于b的元素个数cnt，每次向c中放a元素时，结果加上cnt即可。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">1e5</span>+<span class="number">5</span>;</div><div class="line"></div><div class="line"><span class="keyword">long</span> <span class="keyword">long</span> res=<span class="number">0</span>,cnt=<span class="number">0</span>;</div><div class="line"><span class="keyword">int</span> a[maxn],b[maxn];</div><div class="line"><span class="keyword">int</span> n;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> m,<span class="keyword">int</span> r)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> i,j,k;</div><div class="line">    <span class="keyword">for</span>(i=l;i&lt;=r;++i)b[i]=a[i];</div><div class="line">    cnt=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(i=l,j=m+<span class="number">1</span>,k=l;i&lt;=m&amp;&amp;j&lt;=r;)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span>(b[i]&lt;=b[j])</div><div class="line">        &#123;</div><div class="line">            a[k++]=b[i++];</div><div class="line">            res+=cnt;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span></div><div class="line">        &#123;</div><div class="line">            a[k++]=b[j++];</div><div class="line">            cnt++;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">while</span>(i&lt;=m)</div><div class="line">    &#123;</div><div class="line">        a[k++]=b[i++];</div><div class="line">        res+=cnt;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">while</span>(j&lt;=r)</div><div class="line">        a[k++]=b[j++];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge_sort</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(l&lt;r)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">int</span> m=(l+r)&gt;&gt;<span class="number">1</span>;</div><div class="line">        merge_sort(l,m);</div><div class="line">        merge_sort(m+<span class="number">1</span>,r);</div><div class="line">        merge(l,m,r);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i]);</div><div class="line">    merge_sort(<span class="number">0</span>,n<span class="number">-1</span>);</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%lld"</span>,res);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/hihocoder/">hihocoder</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/hihocoder-分治/">hihocoder 分治</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/08/31/leetcode33/" title="leetcode 33.Search in Rotated Sorted Array" itemprop="url">leetcode 33.Search in Rotated Sorted Array</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2017-08-31T02:21:00.000Z" itemprop="datePublished"> 发表于 2017-08-31</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p><a href="https://leetcode.com/problems/search-in-rotated-sorted-array/description/" target="_blank" rel="external">https://leetcode.com/problems/search-in-rotated-sorted-array/description/</a></p>
<h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>一个旋转过的数组，加上旋转位置是pivot,则在[0,pivot],[pivot+1,n-1]之间两段数组都是有序的，如果target&gt;=nums[0],说明target位于[0,pivot]之间，否则说明target位于[pivot+1,n-1]之间。在进行二分搜索时，我们可以根据nums[mid]和nums[0]的关系以及target和nums[0]的关系来调整左右端点。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//先找到旋转的位置k,在[0,k-1],[k,n-1]之间分别进行二分搜索，找到则返回下标，都找不到则返回-1</span></div><div class="line"><span class="keyword">class</span> Solution &#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">search</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> target)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> l = <span class="number">0</span>,r=nums.size()<span class="number">-1</span>;</div><div class="line">        <span class="keyword">while</span>(l&lt;=r)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">int</span> m = (l+r)/<span class="number">2</span>;</div><div class="line">            <span class="keyword">if</span>(target&gt;=nums[<span class="number">0</span>])<span class="comment">//target位于左边数组</span></div><div class="line">            &#123;</div><div class="line">                <span class="keyword">if</span>(nums[m]&gt;=nums[<span class="number">0</span>])</div><div class="line">                &#123;</div><div class="line">                    <span class="keyword">if</span>(nums[m]&lt;target)</div><div class="line">                        l=m+<span class="number">1</span>;</div><div class="line">                    <span class="keyword">else</span> <span class="keyword">if</span>(nums[m]&gt;target)</div><div class="line">                        r=m<span class="number">-1</span>;</div><div class="line">                    <span class="keyword">else</span></div><div class="line">                        <span class="keyword">return</span> m;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">else</span></div><div class="line">                    r=m<span class="number">-1</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span><span class="comment">//target位于右边数组</span></div><div class="line">            &#123;</div><div class="line">                <span class="keyword">if</span>(nums[m]&lt;nums[<span class="number">0</span>])</div><div class="line">                &#123;</div><div class="line">                    <span class="keyword">if</span>(nums[m]&lt;target)</div><div class="line">                        l=m+<span class="number">1</span>;</div><div class="line">                    <span class="keyword">else</span> <span class="keyword">if</span>(nums[m]&gt;target)</div><div class="line">                        r=m<span class="number">-1</span>;</div><div class="line">                    <span class="keyword">else</span></div><div class="line">                        <span class="keyword">return</span> m;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">else</span></div><div class="line">                    l=m+<span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/算法-leetcode/">算法 leetcode</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/08/27/leetcode87/" title="leetcode 87" itemprop="url">leetcode 87</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2017-08-27T05:30:59.000Z" itemprop="datePublished"> 发表于 2017-08-27</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="树上的动态规划"><a href="#树上的动态规划" class="headerlink" title="树上的动态规划"></a>树上的动态规划</h2><h3 id="例1-leetcode-87"><a href="#例1-leetcode-87" class="headerlink" title="例1.leetcode 87"></a>例1.leetcode 87</h3><p><a href="https://leetcode.com/problems/scramble-string/description/" target="_blank" rel="external">87. Scramble String</a></p>
<h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>如果把一个单词S1切成两部分:<br>–S11–,—-S12—-<br>则如果把S2切成对应的两部分：<br>–S21–,—-S22—-<br>则如果S11和S21能通过变换相等并且S12能和S22通过变换相等，则S1和S2就能通过变换相等。因为树的根节点也能交换左右节点，则S2还可以切成这样两部分：<br>—-S21—-,–S22–<br>同样如果S11和S22能通过变换得到并且S12和S21能通过变换得到，则S1和S2能通过变换得到。</p>
<p>具体写法上，令dp[i][j][l]表示S1.substr(i,l)是否能通过S2.substr(j,l)变换得到，则：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">dp[i][j][l]=(dp[i][j][k]\&amp;\&amp;dp[i+k][j+k][l-k])  </div><div class="line"></div><div class="line">||(dp[i][j+l-k][k]\&amp;\&amp;dp[i+l-k][j][k])</div></pre></td></tr></table></figure></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//子问题没关系，动态规划</span></div><div class="line"><span class="keyword">class</span> Solution &#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isScramble</span><span class="params">(<span class="built_in">string</span> s1, <span class="built_in">string</span> s2)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> m=s1.size(),n=s2.size();</div><div class="line">        <span class="keyword">if</span>(m!=n)<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&gt; dp(n+<span class="number">1</span>,<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;(n+<span class="number">1</span>,<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(n+<span class="number">1</span>,<span class="number">0</span>)));</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> l=<span class="number">1</span>;l&lt;=n;++l)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i+l&lt;=n;++i)</div><div class="line">            &#123;</div><div class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j+l&lt;=n;++j)</div><div class="line">                &#123;</div><div class="line">                    <span class="keyword">if</span>(l==<span class="number">1</span>)dp[i][j][l]=s1[i]==s2[j];</div><div class="line">                    <span class="keyword">else</span> </div><div class="line">                        <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">1</span>;k&lt;l&amp;&amp;!dp[i][j][l];++k)</div><div class="line">                            dp[i][j][l]=dp[i][j][l]||(dp[i][j][k]&amp;&amp;dp[i+k][j+k][l-k])||(dp[i][j+l-k][k]&amp;&amp;dp[i+k][j][l-k]);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> dp[<span class="number">0</span>][<span class="number">0</span>][n];</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/算法-leetcode/">算法 leetcode</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/08/25/leetcode32/" title="leetcode 32" itemprop="url">leetcode 32</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2017-08-25T05:30:59.000Z" itemprop="datePublished"> 发表于 2017-08-25</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p><a href="https://leetcode.com/problems/longest-valid-parentheses/description/" target="_blank" rel="external">https://leetcode.com/problems/longest-valid-parentheses/description/</a></p>
<h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>合法括号序列相关的，通常都和卡特兰数有关，常见做法有栈，动态规划等。</p>
<h3 id="O-n-2-动态规划"><a href="#O-n-2-动态规划" class="headerlink" title="O(n^2^)动态规划"></a>O(n^2^)动态规划</h3><p>将左括号视为1，右括号视为-1，则合法的括号序列前缀和一定都是&gt;=0的，等于0时便是有效的括号序列。令dp[i][j]表示前i项前缀和为j时最长有效括号序列长度。利用-1表示不合法的状态。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">class</span> Solution &#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">longestValidParentheses</span><span class="params">(<span class="built_in">string</span> s)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> n=s.length();</div><div class="line">        <span class="keyword">if</span>(n&lt;<span class="number">2</span>)<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; dp(n+<span class="number">1</span>,<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(n+<span class="number">1</span>,<span class="number">-1</span>));</div><div class="line">        <span class="keyword">int</span> ret=<span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">int</span> k=(s[i]==<span class="string">'('</span>?<span class="number">1</span>:<span class="number">-1</span>);</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;n;++j)</div><div class="line">            &#123;</div><div class="line">                <span class="keyword">if</span>(dp[i][j]!=<span class="number">-1</span>&amp;&amp;j+k&gt;=<span class="number">0</span>)<span class="comment">//当前状态合法且下一状态可转移</span></div><div class="line">                &#123;</div><div class="line">                    dp[i+<span class="number">1</span>][j+k]=max(dp[i+<span class="number">1</span>][j+k],dp[i][j]+<span class="number">1</span>);</div><div class="line">                    <span class="keyword">if</span>(j+k==<span class="number">0</span>)ret=max(ret,dp[i+<span class="number">1</span>][j+k]); </div><div class="line">                &#125;</div><div class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(dp[i][j]==<span class="number">-1</span>&amp;&amp;k==<span class="number">1</span>)</div><div class="line">                    dp[i+<span class="number">1</span>][<span class="number">1</span>]=max(dp[i+<span class="number">1</span>][<span class="number">1</span>],<span class="number">1</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> ret;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<h3 id="O-n-动态规划"><a href="#O-n-动态规划" class="headerlink" title="O(n)动态规划"></a>O(n)动态规划</h3><p>令longest[i]表示以第i项结尾的最长有效括号序列的长度，则如果s[i]==’(‘,则longest[i]=0,因为任何以左括号结尾的序列都不可能是有效序列。如果s[i] ==’)’,且s[i-1] ==’(‘,则longest[i]=longest[i-2]+2。如果s[i] == ‘)’,s[i-1] == ‘)’,则如果s[i-longest[i-1]-1] == ‘(‘,则longest[i]=longest[i-longest[i-1]-2]+2。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//动态规划：注意动态规划的维度对应状态。dp[i][j]表示前i个字符有j个未配对的左括号时最大的有效括号数</span></div><div class="line"><span class="keyword">class</span> Solution &#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">longestValidParentheses</span><span class="params">(<span class="built_in">string</span> s)</span> </span>&#123;</div><div class="line">        s=<span class="string">")"</span>+s;</div><div class="line">        <span class="keyword">int</span> n=s.size(),res=<span class="number">0</span>;</div><div class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; longest(n,<span class="number">0</span>);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;++i)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">if</span>(s[i]==<span class="string">')'</span>&amp;&amp;s[i-longest[i<span class="number">-1</span>]<span class="number">-1</span>]==<span class="string">'('</span>)</div><div class="line">                longest[i]=longest[i<span class="number">-1</span>]+<span class="number">2</span>+(i-longest[i<span class="number">-1</span>]<span class="number">-2</span>&gt;=<span class="number">0</span>?longest[i-longest[i<span class="number">-1</span>]<span class="number">-2</span>]:<span class="number">0</span>);</div><div class="line">            res=max(res,longest[i]);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> res;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<h3 id="利用栈"><a href="#利用栈" class="headerlink" title="利用栈"></a>利用栈</h3><p>左括号就将其索引进栈，遇到右括号，如果栈顶为左括号就将其索引出栈，否则将右括号索引进栈。这样扫面一遍之后，栈中相邻元素之间就是有效序列长度。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">class</span> Solution &#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">longestValidParentheses</span><span class="params">(<span class="built_in">string</span> s)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> n = s.size();</div><div class="line">        <span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt; st;</div><div class="line">        st.push(<span class="number">-1</span>);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">if</span>(st.top()!=<span class="number">-1</span>&amp;&amp;s[i]==<span class="string">')'</span>&amp;&amp;s[st.top()]==<span class="string">'('</span>) st.pop();</div><div class="line">            <span class="keyword">else</span> st.push(i);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> p=n,q=n,res=<span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span>(!st.empty())</div><div class="line">        &#123;</div><div class="line">            q=st.top();</div><div class="line">            st.pop();</div><div class="line">            res=max(res,p-q<span class="number">-1</span>);</div><div class="line">            p=q;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> res;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/算法-leetcode/">算法 leetcode</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/08/23/leetcode44.Wildcard Matching/" title="leetcode 44.Wildcard Matching" itemprop="url">leetcode 44.Wildcard Matching</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2017-08-23T05:30:59.000Z" itemprop="datePublished"> 发表于 2017-08-23</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="动态规划"><a href="#动态规划" class="headerlink" title="动态规划"></a>动态规划</h3><p>题目问的是字符串A和一带通配符字符串B是否匹配。可以利用动态规划解决。令dp[i][j]表示字符串A的前i个字符是否和B的前j个字符相匹配。则：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">if(B[j-1]!=&apos;*&apos;),dp[i][j]=dp[i-1][j-1]\&amp;\&amp;(A[i-1]==B[j-1]||B[j-1]==&apos;?&apos;)</div></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">if(B[j-1]==&apos;*&apos;)dp[i][j]=dp[i-1][j]||dp[i][j-1]</div></pre></td></tr></table></figure>
<h3 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h3><p>dp[0][0]=true;//空串和空串匹配<br>dp[0][j]=p.substr(0,j)==string(j,’<em>‘);//空串和全‘\</em>’串匹配<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">class</span> Solution &#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isMatch</span><span class="params">(<span class="built_in">string</span> s, <span class="built_in">string</span> p)</span> </span>&#123;</div><div class="line">        <span class="comment">//先定状态</span></div><div class="line">        <span class="comment">//dp[i][j]表示s的前i位和p的前j位匹配</span></div><div class="line">        <span class="keyword">int</span> n=s.length(),m=p.length();</div><div class="line">        <span class="keyword">if</span>(m==<span class="number">0</span>&amp;&amp;n==<span class="number">0</span>)<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(m==<span class="number">0</span>)<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(n==<span class="number">0</span>) <span class="keyword">return</span> p==<span class="built_in">string</span>(m,<span class="string">'*'</span>);</div><div class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">bool</span>&gt;&gt; dp(n+<span class="number">1</span>,<span class="built_in">vector</span>&lt;<span class="keyword">bool</span>&gt;(m+<span class="number">1</span>,<span class="literal">false</span>));</div><div class="line">        dp[<span class="number">0</span>][<span class="number">0</span>]=<span class="literal">true</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=m;++j)dp[<span class="number">0</span>][j]=p.substr(<span class="number">0</span>,j)==<span class="built_in">string</span>(j,<span class="string">'*'</span>);</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=m;++j)</div><div class="line">            &#123;</div><div class="line">                <span class="keyword">if</span>(p[j<span class="number">-1</span>]!=<span class="string">'*'</span>)</div><div class="line">                &#123;</div><div class="line">                    dp[i][j]=dp[i<span class="number">-1</span>][j<span class="number">-1</span>]&amp;&amp;(s[i<span class="number">-1</span>]==p[j<span class="number">-1</span>]||p[j<span class="number">-1</span>]==<span class="string">'?'</span>);</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">else</span></div><div class="line">                &#123;</div><div class="line">                    dp[i][j]=dp[i<span class="number">-1</span>][j]||dp[i][j<span class="number">-1</span>];</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> dp[n][m];</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/算法-leetcode-动态规划/">算法 leetcode 动态规划</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/08/22/leetcode10. Regular Expression Matching/" title="leetcode 10. Regular Expression Matching" itemprop="url">leetcode 10. Regular Expression Matching</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2017-08-22T11:30:00.000Z" itemprop="datePublished"> 发表于 2017-08-22</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>动态规划<br>令dp[i][j]表示s[0…i-1]和p[0…j-1]是否匹配，则：</p>
<ol>
<li>dp[i][j]=dp[i-1][j-1],if p[j-1]!=’*’&amp;&amp;(s[i-1]\==p[j-1]||p[j-1]==’.’)</li>
<li>dp[i][j]=dp[i][j-2],if p[j-1]==’*’ </li>
<li>dp[i][j]=dp[i-1][j]&amp;&amp;(s[i-1]==p[j-2]||p[j-2]\==’.’) if p[j-1]\==’<em>‘<br>你可能会好奇为什么最后一种情况没有dp[i-1][j-2],因为如果dp[i-1][j-2]为true,且p[j-1]=’</em>‘，那么dp[i-1][j]必为true,重复0次即可。<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">class</span> Solution &#123;</div><div class="line"><span class="keyword">public</span>:</div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isMatch</span><span class="params">(<span class="built_in">string</span> s, <span class="built_in">string</span> p)</span> </span>&#123;</div><div class="line">        <span class="keyword">int</span> m=s.size(),n=p.size();</div><div class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">bool</span>&gt;&gt; dp(m+<span class="number">1</span>,<span class="built_in">vector</span>&lt;<span class="keyword">bool</span>&gt;(n+<span class="number">1</span>,<span class="literal">false</span>));</div><div class="line">        dp[<span class="number">0</span>][<span class="number">0</span>]=<span class="literal">true</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=m;++i)</div><div class="line">        &#123;</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;++j)</div><div class="line">            &#123;</div><div class="line">                <span class="keyword">if</span>(p[j<span class="number">-1</span>]==<span class="string">'*'</span>)</div><div class="line">                    dp[i][j]=dp[i][j<span class="number">-2</span>]||(i&gt;<span class="number">0</span>&amp;&amp;dp[i<span class="number">-1</span>][j]&amp;&amp;(s[i<span class="number">-1</span>]==p[j<span class="number">-2</span>]||p[j<span class="number">-2</span>]==<span class="string">'.'</span>));</div><div class="line">                <span class="keyword">else</span></div><div class="line">                    dp[i][j]=i&gt;<span class="number">0</span>&amp;&amp;dp[i<span class="number">-1</span>][j<span class="number">-1</span>]&amp;&amp;(s[i<span class="number">-1</span>]==p[j<span class="number">-1</span>]||p[j<span class="number">-1</span>]==<span class="string">'.'</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> dp[m][n];</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></li>
</ol>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/算法-leetcode/">算法 leetcode</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/08/19/并查集/" title="并查集" itemprop="url">并查集</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2017-08-19T11:08:56.000Z" itemprop="datePublished"> 发表于 2017-08-19</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="并查集"><a href="#并查集" class="headerlink" title="并查集"></a>并查集</h3><p>并查集通常用于求解图论中的连通数，或者集合中的不相交集合数等问题，并查集的主要操作包括：</p>
<ul>
<li>合并两个集合</li>
<li>查找某元素属于哪个集合  </li>
</ul>
<p><strong>并查集的实现</strong><br>关键：parent数组</p>
<ol>
<li><p>初始化<br>将所有元素看成独立集合，所有节点的parent为-1</p>
</li>
<li><p>合并<br>将一个组的根节点的parent设为另一个组的根，便将两个组合并了，为了防止树退化，合并时应将树高较小的根节点合到树高较大的根节点。</p>
</li>
<li><p>查询<br>查询某一个节点的根节点，可以递归的查找父节点，直到找到父节点为-1的节点，为了下次查找方便，查找完成后可以直接将路径上的节点连接至根节点。</p>
</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">1000</span>+<span class="number">5</span>;</div><div class="line"><span class="keyword">int</span> pre[maxn];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(pre[x]==x)<span class="keyword">return</span> x;</div><div class="line">    <span class="keyword">return</span> pre[x]=find(pre[x]);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">unite</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span></div><div class="line">&#123;</div><div class="line">    x=find(x);</div><div class="line">    y=find(y);</div><div class="line">    <span class="keyword">if</span>(x==y)<span class="keyword">return</span>;</div><div class="line">    pre[x]=y;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="例1：Battle-Over-Cities"><a href="#例1：Battle-Over-Cities" class="headerlink" title="例1：Battle Over Cities"></a>例1：Battle Over Cities</h3><p><a href="http://pat.zju.edu.cn/contests/pat-a-practise/1013" target="_blank" rel="external">PAT 1013</a><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;memory.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1000</span> + <span class="number">5</span>;</div><div class="line"><span class="keyword">int</span> n, m, k;</div><div class="line"><span class="keyword">struct</span> Edge</div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> from;</div><div class="line">	<span class="keyword">int</span> to;</div><div class="line">&#125;;</div><div class="line"><span class="built_in">vector</span>&lt;Edge&gt; G;</div><div class="line">	<span class="keyword">int</span> par[maxn];</div><div class="line">	<span class="keyword">int</span> height[maxn];</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span></div><div class="line">	&#123;</div><div class="line">		<span class="keyword">if</span> (par[x] == x)<span class="keyword">return</span> x;</div><div class="line">		<span class="keyword">else</span></div><div class="line">			<span class="keyword">return</span> par[x] = find(par[x]);</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">unite</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></div><div class="line">	&#123;</div><div class="line">		x = find(x);</div><div class="line">		y = find(y);</div><div class="line">          	<span class="keyword">if</span>(x==y)<span class="keyword">return</span>;</div><div class="line">		<span class="keyword">if</span> (height[x]&lt;height[y])</div><div class="line">		&#123;</div><div class="line">			par[x] = y;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span></div><div class="line">		&#123;</div><div class="line">			par[y] = x;</div><div class="line">			<span class="keyword">if</span> (height[x] == height[y])++height[x];</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="comment">//freopen("1013.in", "r", stdin);</span></div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d%d\n"</span>, &amp;n, &amp;m, &amp;k);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i&lt;m; ++i)</div><div class="line">	&#123;</div><div class="line">		Edge e;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d\n"</span>, &amp;e.from, &amp;e.to);</div><div class="line">		G.push_back(e);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">while</span> (k--)</div><div class="line">	&#123;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i&lt;=n; ++i)</div><div class="line">		&#123;</div><div class="line">			par[i] = i;</div><div class="line">			height[i] = <span class="number">0</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">int</span> v; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;v);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> e : G)</div><div class="line">		&#123;</div><div class="line">			<span class="keyword">if</span> (e.from != v&amp;&amp;e.to != v)</div><div class="line">				unite(e.from, e.to);</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		<span class="keyword">int</span> cnt = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</div><div class="line">		&#123;</div><div class="line">			<span class="keyword">if</span> (par[i] == i&amp;&amp;i != v)++cnt;</div><div class="line">		&#125;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, cnt<span class="number">-1</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="带权并查集"><a href="#带权并查集" class="headerlink" title="带权并查集"></a>带权并查集</h3><p>带权并查集除了pre数组外，还带有一个value数组，描述i和其父节点的关系。</p>
<h3 id="POJ-1182-食物链"><a href="#POJ-1182-食物链" class="headerlink" title="POJ 1182 食物链"></a>POJ 1182 食物链</h3><h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>带权并查集，首先分析节点-父节点-根节点的权值关系，不妨令权值有三种，0，1，2。0表示父节点被子节点吃，1表示父节点和子节点同类，2表示父节点吃子节点。<br>以X-Y-Z来表示根节点到叶节点的一条路径来考虑路径压缩过程中权值的更新关系：</p>
<table>
<thead>
<tr>
<th>X-Y</th>
<th>Y-Z</th>
<th>X-Z </th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>0</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td>0</td>
<td>0</td>
<td>2</td>
</tr>
</tbody>
</table>
<p>可以看出value[x]=(2+value[x]+value[pre[x]])%3</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;functional&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;list&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cctype&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;fstream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;sstream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iomanip&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;time.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">50000</span> + <span class="number">5</span>;</div><div class="line"><span class="keyword">int</span> fa[maxn], value[maxn];</div><div class="line"><span class="keyword">int</span> N, M;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N; ++i)</div><div class="line">	&#123;</div><div class="line">		fa[i] = i;</div><div class="line">		value[i] = <span class="number">1</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">if</span> (x == fa[x])<span class="keyword">return</span> x;</div><div class="line">	<span class="keyword">int</span> y = fa[x];</div><div class="line">	fa[x] = find(y);</div><div class="line">	value[x] = (<span class="number">2</span> + value[x] + value[y]) % <span class="number">3</span>;</div><div class="line">	<span class="keyword">return</span> fa[x];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> t, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">if</span> (x &gt; N || y &gt; N)<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	<span class="keyword">if</span> (t == <span class="number">2</span> &amp;&amp; x == y)<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	<span class="keyword">int</span> fx = find(x), fy = find(y);</div><div class="line">	<span class="keyword">if</span> (fx == fy)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">int</span> s = (<span class="number">2</span> + value[x] + t) % <span class="number">3</span>;</div><div class="line">		<span class="keyword">if</span> (s != value[y]) <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">else</span></div><div class="line">	&#123;</div><div class="line">		fa[fx] = fy;</div><div class="line">		<span class="keyword">int</span> s = (<span class="number">2</span> + <span class="number">2</span> - t + value[y]) % <span class="number">3</span>;</div><div class="line">		value[fx] = (<span class="number">2</span> + <span class="number">2</span> - value[x] + s) % <span class="number">3</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	freopen(<span class="string">"1182.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;N,&amp;M);</div><div class="line">	init();</div><div class="line">	<span class="keyword">int</span> ret = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; ++i)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">int</span> d, x, y;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;d,&amp;x,&amp;y);</div><div class="line">		<span class="keyword">if</span> (!check(d, x, y))++ret;</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d"</span>,ret);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/并查集/">并查集</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/08/17/线段树/" title="线段树" itemprop="url">线段树</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2017-08-16T16:14:53.000Z" itemprop="datePublished"> 发表于 2017-08-17</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="线段树"><a href="#线段树" class="headerlink" title="线段树"></a>线段树</h2><p>给定数列a[0],a[1],a[2],…a[n-1],线段树可以在log(n)时间内完成下列操作：  </p>
<ol>
<li>给定s和t,求区间[s,t]as+..+at的和。</li>
<li>给定s和t,求区间[s,t]中as,…,at的最小/大值。</li>
<li>给定i和x,把ai的值改为x.</li>
</ol>
<h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>线段树的每个节点表示一个区间，子节点则表示父节点的左右半区间，例如父亲的区间是[a,b]，那么(c=(a+b)/2)左儿子的区间[a,c],右儿子的区间是[c+1,b]。<br>线段树是一棵完全二叉树，可以使用数组来存储，对于第i个元素，其左右孩子分别为2<em>i和2</em>i+1,根节点索引为1。一般需要开给定数列长度n的四倍。</p>
<p><strong>关键是分治！</strong></p>
<h4 id="线段树模板"><a href="#线段树模板" class="headerlink" title="线段树模板"></a>线段树模板</h4><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div></pre></td><td class="code"><pre><div class="line">#include&lt;iostream&gt;</div><div class="line">#include&lt;algorithm&gt;</div><div class="line"></div><div class="line">using namespace std;</div><div class="line"></div><div class="line">#define mid(l,r) ((l+r)&gt;&gt;1)</div><div class="line">#define lson(i) (i&lt;&lt;1)</div><div class="line">#define rson(i) ((i&lt;&lt;1)|1)</div><div class="line"></div><div class="line">const int maxn = 1e6 + 5;</div><div class="line"></div><div class="line">struct seg</div><div class="line">&#123;</div><div class="line">	int l, r;</div><div class="line">	int min, max, sum;</div><div class="line">	seg()&#123; min = INT_MAX; max = INT_MIN; sum = 0; &#125;</div><div class="line">	int lazy;</div><div class="line">&#125;ST[maxn &lt;&lt; 2];</div><div class="line"></div><div class="line">void push_up(int i)</div><div class="line">&#123;</div><div class="line">	ST[i].min = min(ST[lson(i)].min, ST[rson(i)].min);</div><div class="line">	ST[i].max = max(ST[lson(i)].max, ST[rson(i)].max);</div><div class="line">	ST[i].sum = ST[lson(i)].sum + ST[rson(i)].sum;</div><div class="line">&#125;</div><div class="line"></div><div class="line">void build(int i, int l, int r)</div><div class="line">&#123;</div><div class="line">	ST[i].l = l; ST[i].r = r; ST[i].lazy = 0;</div><div class="line">	if (l == r)</div><div class="line">	&#123;</div><div class="line">		int val; scanf("%d", &amp;val);</div><div class="line">		ST[i].min = val;</div><div class="line">		ST[i].max = val;</div><div class="line">		ST[i].sum = val;</div><div class="line">		return;</div><div class="line">	&#125;</div><div class="line">	int m = mid(l, r);</div><div class="line">	build(lson(i), l, m);</div><div class="line">	build(rson(i), m + 1, r);</div><div class="line">	push_up(i);</div><div class="line">&#125;</div><div class="line"></div><div class="line">void query(int i, int l, int r,seg &amp;s)</div><div class="line">&#123;</div><div class="line">	if (ST[i].l &gt;= l&amp;&amp;ST[i].r &lt;= r)</div><div class="line">	&#123;</div><div class="line">		s.min = min(s.min,ST[i].min);</div><div class="line">		s.max = max(s.max,ST[i].max);</div><div class="line">		s.sum += ST[i].sum;</div><div class="line">		return;</div><div class="line">	&#125;</div><div class="line">	int m = mid(ST[i].l, ST[i].r);</div><div class="line">	if(l&gt;m)query(rson(i), l,r,s);//查询区间位于右子树</div><div class="line">	else if(r&lt;=m)query(lson(i),l,r,s);//查询区间位于左子树</div><div class="line">	else</div><div class="line">	&#123;</div><div class="line">		query(lson(i), l, m, s);</div><div class="line">		query(rson(i),m+1,r,s);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">void update_point(int i, int l, int r, int id, int val)</div><div class="line">&#123;</div><div class="line">	if (l == r)</div><div class="line">	&#123;</div><div class="line">		ST[i].min = val;</div><div class="line">		ST[i].max = val;</div><div class="line">		ST[i].sum = val;</div><div class="line">		return;</div><div class="line">	&#125;</div><div class="line">	if (id&lt;=mid(l,r))update_point(lson(i), l, mid(l, r), id, val);</div><div class="line">	else update_point(rson(i), mid(l, r) + 1, r, id, val);</div><div class="line">	push_up(i);</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">int N, Q;</div><div class="line">int main()</div><div class="line">&#123;</div><div class="line">	//freopen("1077.txt","r",stdin);</div><div class="line">	scanf("%d\n", &amp;N);</div><div class="line">	build(1, 1, N);</div><div class="line">	scanf("%d\n", &amp;Q);</div><div class="line">	while (Q--)</div><div class="line">	&#123;</div><div class="line">		int o, x, y; scanf("%d%d%d", &amp;o, &amp;x, &amp;y);</div><div class="line">		if (o)update_point(1, 1, N, x, y);</div><div class="line">		else</div><div class="line">		&#123;</div><div class="line">			seg s; query(1, x, y, s);</div><div class="line">			printf("%d\n", s.min);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="区间更新"><a href="#区间更新" class="headerlink" title="区间更新"></a>区间更新</h4><p>线段树的区间修改也是将区间分成子区间，但是要加一个标记，称作懒惰标记。<br><strong>标记的含义：</strong><br>本节点的统计信息已经根据标记更新过了，但是本节点的子节点仍需要进行更新<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div></pre></td><td class="code"><pre><div class="line">//#include&lt;bits/stdc++.h&gt;</div><div class="line">#include&lt;iostream&gt;</div><div class="line">#include&lt;algorithm&gt;</div><div class="line">using namespace std;</div><div class="line"></div><div class="line">#define mid(l,r) ((l+r)&gt;&gt;1)</div><div class="line">#define lson(i) (i&lt;&lt;1)</div><div class="line">#define rson(i) ((i&lt;&lt;1)|1)</div><div class="line"></div><div class="line">const int maxn = 1e5 + 5;</div><div class="line"></div><div class="line">struct seg&#123;</div><div class="line">	int l, r;</div><div class="line">	int min, sum;</div><div class="line">	bool set;</div><div class="line">	seg()&#123; min = INT_MAX; sum = 0; set = false; &#125;</div><div class="line">	seg(int _l,int _r,int _min, int _sum, bool _set)&#123;</div><div class="line">		l = _l;</div><div class="line">		r = _r;</div><div class="line">		min = _min;</div><div class="line">		sum = _sum;</div><div class="line">		set = _set;</div><div class="line">	&#125;</div><div class="line">&#125;ST[maxn &lt;&lt; 2];</div><div class="line"></div><div class="line">void push_up(int i)&#123;</div><div class="line">	ST[i].min = min(ST[lson(i)].min,ST[rson(i)].min);</div><div class="line">	ST[i].sum = ST[lson(i)].sum + ST[rson(i)].sum;</div><div class="line">&#125;</div><div class="line">void push_down(seg parent, seg &amp;child, int w)&#123;</div><div class="line">	int val = parent.min;</div><div class="line">	if (parent.set)child = seg(child.l, child.r, val, w*val, true);</div><div class="line">&#125;</div><div class="line">void push_down(int i, int w)&#123;</div><div class="line">	push_down(ST[i], ST[lson(i)], (w + 1) &gt;&gt; 1);</div><div class="line">	push_down(ST[i], ST[rson(i)], w &gt;&gt; 1);</div><div class="line">	ST[i].set = false;</div><div class="line">&#125;</div><div class="line">void build(int i, int l, int r)&#123;</div><div class="line">	ST[i].l = l; ST[i].r = r;</div><div class="line">	if (l == r)&#123;</div><div class="line">		int val; scanf("%d", &amp;val);</div><div class="line">		ST[i].min = val;</div><div class="line">		ST[i].sum = val;</div><div class="line">		return;</div><div class="line">	&#125;</div><div class="line">	build(lson(i), l, mid(l, r));</div><div class="line">	build(rson(i), mid(l, r) + 1, r);</div><div class="line">	push_up(i);</div><div class="line">&#125;</div><div class="line">void query(int i, int l, int r, seg &amp;s)&#123;</div><div class="line">	if (l &lt;= ST[i].l&amp;&amp;ST[i].r &lt;= r)&#123;</div><div class="line">		s.min = min(s.min, ST[i].min);</div><div class="line">		s.sum += ST[i].sum;</div><div class="line">		return;</div><div class="line">	&#125;</div><div class="line">	push_down(i, ST[i].r - ST[i].l + 1);</div><div class="line">	int m = mid(ST[i].l, ST[i].r);</div><div class="line">	if (r &lt;= m)query(lson(i), l, r, s);</div><div class="line">	else if (l&gt;m)query(rson(i), l, r, s);</div><div class="line">	else&#123;</div><div class="line">		query(lson(i), l, m, s);</div><div class="line">		query(rson(i), m + 1, r, s);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line">void update(int i, int l, int r, int val)&#123;</div><div class="line">	if (l &lt;= ST[i].l&amp;&amp;ST[i].r &lt;= r)&#123;</div><div class="line">		push_down(seg(0,0,val, 0, true), ST[i], ST[i].r - ST[i].l + 1);</div><div class="line">		return;</div><div class="line">	&#125;</div><div class="line">	push_down(i, ST[i].r - ST[i].l + 1);</div><div class="line">	int m = mid(ST[i].l, ST[i].r);</div><div class="line">	if (r &lt;= m)update(lson(i), l, r, val);</div><div class="line">	else if (l&gt;m)update(rson(i), l, r, val);</div><div class="line">	else&#123;</div><div class="line">		update(lson(i), l, m, val);</div><div class="line">		update(rson(i), m + 1, r, val);</div><div class="line">	&#125;</div><div class="line">	push_up(i);</div><div class="line">&#125;</div><div class="line">int N, Q;</div><div class="line">int main()&#123;</div><div class="line">	freopen("1078.txt","r",stdin);</div><div class="line">	scanf("%d", &amp;N);</div><div class="line">	build(1, 1, N);</div><div class="line">	scanf("%d", &amp;Q);</div><div class="line">	while (Q--)&#123;</div><div class="line">		int o, x, y, v; scanf("%d%d%d", &amp;o, &amp;x, &amp;y);</div><div class="line">		if (o)&#123;</div><div class="line">			scanf("%d", &amp;v);</div><div class="line">			update(1, x, y, v);</div><div class="line">		&#125;</div><div class="line">		else&#123;</div><div class="line">			seg s;</div><div class="line">			query(1, x, y, s);</div><div class="line">			printf("%d\n", s.sum);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="最终模板"><a href="#最终模板" class="headerlink" title="最终模板"></a>最终模板</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div></pre></td><td class="code"><pre><div class="line">#include&lt;iostream&gt;</div><div class="line">#include&lt;algorithm&gt;</div><div class="line">#include&lt;bits/stdc++.h&gt;</div><div class="line">using namespace std;</div><div class="line"></div><div class="line">#define mid(l,r) ((l+r)&gt;&gt;1)</div><div class="line">#define lson(i) (i&lt;&lt;1)</div><div class="line">#define rson(i) ((i&lt;&lt;1)|1)</div><div class="line"></div><div class="line">const int maxn = 1e5 + 5;</div><div class="line"></div><div class="line">struct seg&#123;</div><div class="line">	int l, r;</div><div class="line">	int min, max, sum;</div><div class="line">	int add;</div><div class="line">	bool set;</div><div class="line">	seg()&#123; min = INT_MAX; max = INT_MIN; sum = 0; add = 0; set = false; &#125;</div><div class="line">	seg(int _l,int _r,int _min,int _max,int _sum,int _add,int _set)&#123;</div><div class="line">		l = _l; r = _r;</div><div class="line">		min = _min; max = _max; sum =_sum;</div><div class="line">		add = _add; set = _set;</div><div class="line">	&#125;</div><div class="line">&#125;ST[maxn&lt;&lt;2];</div><div class="line"></div><div class="line">void push_up(int i)</div><div class="line">&#123;</div><div class="line">	ST[i].min = min(ST[lson(i)].min,ST[rson(i)].min);</div><div class="line">	ST[i].max = max(ST[lson(i)].max,ST[rson(i)].max);</div><div class="line">	ST[i].sum = ST[lson(i)].sum + ST[rson(i)].sum;</div><div class="line">&#125;</div><div class="line"></div><div class="line">void push_down(seg parent,seg &amp;child,int w)&#123;</div><div class="line">	int val = parent.min, add = parent.add;</div><div class="line">	if (parent.set)child = seg(child.l, child.r, val, val, w*val, 0, true);</div><div class="line">	else if (child.set)child = seg(child.l, child.r, child.min + add, child.max + add, child.sum + w*add, 0, true);</div><div class="line">	else child = seg(child.l, child.r, child.min + add, child.max + add, child.sum + w*add, child.add + add, false);</div><div class="line">&#125;</div><div class="line"></div><div class="line">void push_down(int i, int w)</div><div class="line">&#123;</div><div class="line">	push_down(ST[i], ST[lson(i)], (w+1)&gt;&gt;1);</div><div class="line">	push_down(ST[i], ST[rson(i)],  w&gt;&gt;1);</div><div class="line">	ST[i].add = 0; ST[i].set = false;</div><div class="line">&#125;</div><div class="line"></div><div class="line">void build(int i, int l, int r)</div><div class="line">&#123;</div><div class="line">	ST[i].l = l; ST[i].r = r;</div><div class="line">	if (l == r)</div><div class="line">	&#123;</div><div class="line">		int val=0;//scanf("%d",&amp;val);</div><div class="line">		ST[i] = seg(l, r, val, val, val, 0, false);</div><div class="line">		return;</div><div class="line">	&#125;</div><div class="line">	int m = mid(l, r);</div><div class="line">	build(lson(i), l, m);</div><div class="line">	build(rson(i),m+1,r);</div><div class="line">	push_up(i);</div><div class="line">&#125;</div><div class="line"></div><div class="line">void query(int i, int l, int r, seg &amp;s)</div><div class="line">&#123;</div><div class="line">	if (l &lt;= ST[i].l&amp;&amp;ST[i].r &lt;= r)</div><div class="line">	&#123;</div><div class="line">		s.min = min(s.min, ST[i].min);</div><div class="line">		s.max = max(s.max, ST[i].max);</div><div class="line">		s.sum += ST[i].sum;</div><div class="line">		return;</div><div class="line">	&#125;</div><div class="line">	push_down(i, ST[i].r - ST[i].l + 1);</div><div class="line">	int m = mid(ST[i].l, ST[i].r);</div><div class="line">	if (r &lt;= m)query(lson(i), l, r, s);</div><div class="line">	else if (l &gt; m)query(rson(i), l, r, s);</div><div class="line">	else&#123;</div><div class="line">		query(lson(i), l, m, s);</div><div class="line">		query(rson(i), m + 1, r, s);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">/*op为0表示加上val,为1表示赋值为val*/</div><div class="line">void update(int i, int l, int r, int val,int op)</div><div class="line">&#123;</div><div class="line">	if (l &lt;= ST[i].l&amp;&amp;ST[i].r &lt;= r)</div><div class="line">	&#123;</div><div class="line">		if (op)push_down(seg(0, 0, val, 0, 0, 0, true), ST[i], ST[i].r - ST[i].l + 1);</div><div class="line">		else push_down(seg(0, 0, 0, 0, 0, val, false), ST[i], ST[i].r - ST[i].l + 1);</div><div class="line">		return;</div><div class="line">	&#125;</div><div class="line">	push_down(i,ST[i].r-ST[i].l+1);</div><div class="line">	int m = mid(ST[i].l,ST[i].r);</div><div class="line">	if (r &lt;= m)update(lson(i), l, r, val, op);</div><div class="line">	else if (l &gt; m)update(rson(i), l, r, val, op);</div><div class="line">	else&#123;</div><div class="line">		update(lson(i),l,m,val,op);</div><div class="line">		update(rson(i), m + 1, r, val, op);</div><div class="line">	&#125;</div><div class="line">	push_up(i);</div><div class="line">&#125;</div><div class="line">int N;</div><div class="line">int main()</div><div class="line">&#123;</div><div class="line">	//freopen("1665.txt","r",stdin);</div><div class="line">	build(1, 1, maxn);</div><div class="line">	scanf("%d\n", &amp;N);</div><div class="line">	while (N--)</div><div class="line">	&#123;</div><div class="line">		int x, y; scanf("%d%d", &amp;x, &amp;y);</div><div class="line">		seg s; query(1, x, y, s);</div><div class="line">		update(1, x, y, s.max + 1, 1);</div><div class="line">		printf("%d\n",s.max+1);</div><div class="line">	&#125;</div><div class="line">	return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/线段树/">线段树</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/08/16/树状数组/" title="树状数组" itemprop="url">树状数组</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2017-08-16T14:36:45.000Z" itemprop="datePublished"> 发表于 2017-08-16</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="树状数组"><a href="#树状数组" class="headerlink" title="树状数组"></a>树状数组</h3><p><strong>适合单点更新的区间求和。</strong><br>树状数组(BIT)是能够在O(log(n))时间内完成下列操作的数据结构。</p>
<ol>
<li>给定i,计算a1+a2+…+ai</li>
<li>给定i和x,执行ai+=x</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1000</span>;</div><div class="line"><span class="keyword">int</span> BIT[maxn + <span class="number">1</span>];</div><div class="line"><span class="keyword">int</span> n;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> i)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> ans = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span> (i)</div><div class="line">	&#123;</div><div class="line">		ans += BIT[i];</div><div class="line">		i -= (i&amp;-i);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> x)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">while</span> (i &lt;= n)</div><div class="line">	&#123;</div><div class="line">		BIT[i] += x;</div><div class="line">		i += (i&amp;-i);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">bulid</span><span class="params">(<span class="keyword">int</span> a[])</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,x;i&lt;=n;++i)</div><div class="line">    &#123;</div><div class="line">        BIT[i]+=a[i<span class="number">-1</span>];</div><div class="line">        <span class="keyword">if</span>((x=i+(i&amp;<span class="number">-1</span>))&lt;=n)BIT[x]+=BIT[i];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="1-逆序对的个数"><a href="#1-逆序对的个数" class="headerlink" title="1.逆序对的个数"></a>1.逆序对的个数</h3><p>给定一个1~n的排列a1,a2,…an,求an的中逆序对的个数。</p>
<h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>定义一个数组C,每次读入一个a[i]，就将C[a[i]]加1，如果一个比a[i]小的数a[j]在a[i]之前出现了(j&lt;i)，此时C[a[j]]一定大于0，这时C中前a[i]项的和就是满足j&lt;=i,a[j]&lt;=a[i]的个数。所以我们需要一个能够对某项加1，并求前几项的和的数据结构，树状数组就能很好地完成这项任务。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">10001</span>;</div><div class="line"><span class="keyword">int</span> BIT[maxn];</div><div class="line"><span class="keyword">int</span> n;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> i)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> s=<span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span>(i)</div><div class="line">    &#123;</div><div class="line">        s+=BIT[i];</div><div class="line">        i-=(i&amp;-i);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> s;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> x)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">while</span>(i&lt;=n)</div><div class="line">    &#123;</div><div class="line">        BIT[i]+=x;</div><div class="line">        i+=(i&amp;-i);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> a[])</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ans = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</div><div class="line">    &#123;</div><div class="line">        add(a[i],<span class="number">1</span>);<span class="comment">//将a[i]出现次数加1</span></div><div class="line">        ans+=i+<span class="number">1</span>-sum(a[i]);<span class="comment">//在a[i]之前出现的数是满足j&lt;=i,a[j]&lt;=a[i]的个数，将总个数减去该数即为逆序对数</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> ans;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="树状数组模板"><a href="#树状数组模板" class="headerlink" title="树状数组模板"></a>树状数组模板</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span>+<span class="number">5</span>;</div><div class="line"><span class="keyword">int</span> BIT[maxn];</div><div class="line"><span class="keyword">int</span> n;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">lowbit</span><span class="params">(<span class="keyword">int</span> i)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">return</span> i&amp;(-i);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> x)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">while</span> (i &lt;= n)</div><div class="line">	&#123;</div><div class="line">		BIT[i] += x;</div><div class="line">		i += lowbit(i);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> i)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> ans = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span> (i)</div><div class="line">	&#123;</div><div class="line">		ans += BIT[i];</div><div class="line">		i -= lowbit(i);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> a[])</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>,x; i &lt;= n; ++i)</div><div class="line">	&#123;</div><div class="line">		BIT[i] += a[i - <span class="number">1</span>];</div><div class="line">		<span class="keyword">if</span> ((x = i + lowbit(i)) &lt;= n)BIT[x] += BIT[i];</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/算法/">算法</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/算法/">算法</a><a href="/tags/笔试/">笔试</a><a href="/tags/树状数组/">树状数组</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>







  <nav id="page-nav" class="clearfix">
    <a class="extend prev" rel="prev" href="/page/4/"><span></span>Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/6/">Next<span></span></a>
  </nav>

</div>
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  


  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/PAT/" title="PAT">PAT<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Parallel-Studio/" title="Parallel Studio">Parallel Studio<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Python/" title="Python">Python<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/hihocoder/" title="hihocoder">hihocoder<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/生活随笔/" title="生活随笔">生活随笔<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/算法/" title="算法">算法<sup>3</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/算法/" title="算法">算法<sup>24</sup></a></li>
			
		
			
				<li><a href="/tags/算法-leetcode/" title="算法 leetcode">算法 leetcode<sup>9</sup></a></li>
			
		
			
				<li><a href="/tags/算法-动态规划/" title="算法 动态规划">算法 动态规划<sup>8</sup></a></li>
			
		
			
				<li><a href="/tags/Python/" title="Python">Python<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/笔试/" title="笔试">笔试<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/Kickstart-Google/" title="Kickstart Google">Kickstart Google<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/强化学习/" title="强化学习">强化学习<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/PAT/" title="PAT">PAT<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/KMP算法/" title="KMP算法">KMP算法<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/正则表达式/" title="正则表达式">正则表达式<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/MNIST-TensorFlow/" title="MNIST TensorFlow">MNIST TensorFlow<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/树状数组/" title="树状数组">树状数组<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Parallel-Studio/" title="Parallel Studio">Parallel Studio<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/ICC/" title="ICC">ICC<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/MKL/" title="MKL">MKL<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/深度学习-TensorFlow/" title="深度学习 TensorFlow">深度学习 TensorFlow<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Trie树/" title="Trie树">Trie树<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/hihocoder-分治/" title="hihocoder 分治">hihocoder 分治<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/DFA/" title="DFA">DFA<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/C/" title="C">C<sup>1</sup></a></li>
			
		
		</ul>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	
	<div class="social-font" class="clearfix">
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2018 
		
		<a href="/about" target="_blank" title="洛绍川">洛绍川</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>










<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End --><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->

  </body>
 </html>
