
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>我是小韩同学</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="洛绍川">
    

    
    <meta name="description" content="code">
<meta property="og:type" content="website">
<meta property="og:title" content="我是小韩同学">
<meta property="og:url" content="http://www.luoshaochuan.com/page/3/index.html">
<meta property="og:site_name" content="我是小韩同学">
<meta property="og:description" content="code">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="我是小韩同学">
<meta name="twitter:description" content="code">

    
    
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="我是小韩同学" title="我是小韩同学"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="我是小韩同学">我是小韩同学</a></h1>
				<h2 class="blog-motto"></h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
						<li><a href="/tags">标签</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:www.luoshaochuan.com">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main">

   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/08/19/并查集/" title="并查集" itemprop="url">并查集</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2017-08-19T11:08:56.000Z" itemprop="datePublished"> 发表于 2017-08-19</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="并查集"><a href="#并查集" class="headerlink" title="并查集"></a>并查集</h3><p>并查集通常用于求解图论中的连通数，或者集合中的不相交集合数等问题，并查集的主要操作包括：</p>
<ul>
<li>合并两个集合</li>
<li>查找某元素属于哪个集合  </li>
</ul>
<p><strong>并查集的实现</strong><br>关键：parent数组</p>
<ol>
<li><p>初始化<br>将所有元素看成独立集合，所有节点的parent为-1</p>
</li>
<li><p>合并<br>将一个组的根节点的parent设为另一个组的根，便将两个组合并了，为了防止树退化，合并时应将树高较小的根节点合到树高较大的根节点。</p>
</li>
<li><p>查询<br>查询某一个节点的根节点，可以递归的查找父节点，直到找到父节点为-1的节点，为了下次查找方便，查找完成后可以直接将路径上的节点连接至根节点。</p>
</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">1000</span>+<span class="number">5</span>;</div><div class="line"><span class="keyword">int</span> pre[maxn];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(pre[x]==x)<span class="keyword">return</span> x;</div><div class="line">    <span class="keyword">return</span> pre[x]=find(pre[x]);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">unite</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span></div><div class="line">&#123;</div><div class="line">    x=find(x);</div><div class="line">    y=find(y);</div><div class="line">    <span class="keyword">if</span>(x==y)<span class="keyword">return</span>;</div><div class="line">    pre[x]=y;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="例1：Battle-Over-Cities"><a href="#例1：Battle-Over-Cities" class="headerlink" title="例1：Battle Over Cities"></a>例1：Battle Over Cities</h3><p><a href="http://pat.zju.edu.cn/contests/pat-a-practise/1013" target="_blank" rel="external">PAT 1013</a><br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;memory.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1000</span> + <span class="number">5</span>;</div><div class="line"><span class="keyword">int</span> n, m, k;</div><div class="line"><span class="keyword">struct</span> Edge</div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> from;</div><div class="line">	<span class="keyword">int</span> to;</div><div class="line">&#125;;</div><div class="line"><span class="built_in">vector</span>&lt;Edge&gt; G;</div><div class="line">	<span class="keyword">int</span> par[maxn];</div><div class="line">	<span class="keyword">int</span> height[maxn];</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span></div><div class="line">	&#123;</div><div class="line">		<span class="keyword">if</span> (par[x] == x)<span class="keyword">return</span> x;</div><div class="line">		<span class="keyword">else</span></div><div class="line">			<span class="keyword">return</span> par[x] = find(par[x]);</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">unite</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></div><div class="line">	&#123;</div><div class="line">		x = find(x);</div><div class="line">		y = find(y);</div><div class="line">          	<span class="keyword">if</span>(x==y)<span class="keyword">return</span>;</div><div class="line">		<span class="keyword">if</span> (height[x]&lt;height[y])</div><div class="line">		&#123;</div><div class="line">			par[x] = y;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span></div><div class="line">		&#123;</div><div class="line">			par[y] = x;</div><div class="line">			<span class="keyword">if</span> (height[x] == height[y])++height[x];</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="comment">//freopen("1013.in", "r", stdin);</span></div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d%d\n"</span>, &amp;n, &amp;m, &amp;k);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i&lt;m; ++i)</div><div class="line">	&#123;</div><div class="line">		Edge e;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d\n"</span>, &amp;e.from, &amp;e.to);</div><div class="line">		G.push_back(e);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">while</span> (k--)</div><div class="line">	&#123;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i&lt;=n; ++i)</div><div class="line">		&#123;</div><div class="line">			par[i] = i;</div><div class="line">			height[i] = <span class="number">0</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">int</span> v; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;v);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> e : G)</div><div class="line">		&#123;</div><div class="line">			<span class="keyword">if</span> (e.from != v&amp;&amp;e.to != v)</div><div class="line">				unite(e.from, e.to);</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		<span class="keyword">int</span> cnt = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; ++i)</div><div class="line">		&#123;</div><div class="line">			<span class="keyword">if</span> (par[i] == i&amp;&amp;i != v)++cnt;</div><div class="line">		&#125;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, cnt<span class="number">-1</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="带权并查集"><a href="#带权并查集" class="headerlink" title="带权并查集"></a>带权并查集</h3><p>带权并查集除了pre数组外，还带有一个value数组，描述i和其父节点的关系。</p>
<h3 id="POJ-1182-食物链"><a href="#POJ-1182-食物链" class="headerlink" title="POJ 1182 食物链"></a>POJ 1182 食物链</h3><h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>带权并查集，首先分析节点-父节点-根节点的权值关系，不妨令权值有三种，0，1，2。0表示父节点被子节点吃，1表示父节点和子节点同类，2表示父节点吃子节点。<br>以X-Y-Z来表示根节点到叶节点的一条路径来考虑路径压缩过程中权值的更新关系：</p>
<table>
<thead>
<tr>
<th>X-Y</th>
<th>Y-Z</th>
<th>X-Z </th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>0</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td>0</td>
<td>0</td>
<td>2</td>
</tr>
</tbody>
</table>
<p>可以看出value[x]=(2+value[x]+value[pre[x]])%3</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;functional&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;list&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cctype&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;fstream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;sstream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iomanip&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;time.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">50000</span> + <span class="number">5</span>;</div><div class="line"><span class="keyword">int</span> fa[maxn], value[maxn];</div><div class="line"><span class="keyword">int</span> N, M;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= N; ++i)</div><div class="line">	&#123;</div><div class="line">		fa[i] = i;</div><div class="line">		value[i] = <span class="number">1</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">if</span> (x == fa[x])<span class="keyword">return</span> x;</div><div class="line">	<span class="keyword">int</span> y = fa[x];</div><div class="line">	fa[x] = find(y);</div><div class="line">	value[x] = (<span class="number">2</span> + value[x] + value[y]) % <span class="number">3</span>;</div><div class="line">	<span class="keyword">return</span> fa[x];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> t, <span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">if</span> (x &gt; N || y &gt; N)<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	<span class="keyword">if</span> (t == <span class="number">2</span> &amp;&amp; x == y)<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	<span class="keyword">int</span> fx = find(x), fy = find(y);</div><div class="line">	<span class="keyword">if</span> (fx == fy)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">int</span> s = (<span class="number">2</span> + value[x] + t) % <span class="number">3</span>;</div><div class="line">		<span class="keyword">if</span> (s != value[y]) <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">else</span></div><div class="line">	&#123;</div><div class="line">		fa[fx] = fy;</div><div class="line">		<span class="keyword">int</span> s = (<span class="number">2</span> + <span class="number">2</span> - t + value[y]) % <span class="number">3</span>;</div><div class="line">		value[fx] = (<span class="number">2</span> + <span class="number">2</span> - value[x] + s) % <span class="number">3</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	freopen(<span class="string">"1182.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;N,&amp;M);</div><div class="line">	init();</div><div class="line">	<span class="keyword">int</span> ret = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; M; ++i)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">int</span> d, x, y;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;d,&amp;x,&amp;y);</div><div class="line">		<span class="keyword">if</span> (!check(d, x, y))++ret;</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d"</span>,ret);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/并查集/">并查集</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/08/17/线段树/" title="线段树" itemprop="url">线段树</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2017-08-16T16:14:53.000Z" itemprop="datePublished"> 发表于 2017-08-17</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="线段树"><a href="#线段树" class="headerlink" title="线段树"></a>线段树</h2><p>给定数列a[0],a[1],a[2],…a[n-1],线段树可以在log(n)时间内完成下列操作：  </p>
<ol>
<li>给定s和t,求区间[s,t]as+..+at的和。</li>
<li>给定s和t,求区间[s,t]中as,…,at的最小/大值。</li>
<li>给定i和x,把ai的值改为x.</li>
</ol>
<h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>线段树的每个节点表示一个区间，子节点则表示父节点的左右半区间，例如父亲的区间是[a,b]，那么(c=(a+b)/2)左儿子的区间[a,c],右儿子的区间是[c+1,b]。<br>线段树是一棵完全二叉树，可以使用数组来存储，对于第i个元素，其左右孩子分别为2<em>i和2</em>i+1,根节点索引为1。一般需要开给定数列长度n的四倍。</p>
<p><strong>关键是分治！</strong></p>
<h4 id="线段树模板"><a href="#线段树模板" class="headerlink" title="线段树模板"></a>线段树模板</h4><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div></pre></td><td class="code"><pre><div class="line">#include&lt;iostream&gt;</div><div class="line">#include&lt;algorithm&gt;</div><div class="line"></div><div class="line">using namespace std;</div><div class="line"></div><div class="line">#define mid(l,r) ((l+r)&gt;&gt;1)</div><div class="line">#define lson(i) (i&lt;&lt;1)</div><div class="line">#define rson(i) ((i&lt;&lt;1)|1)</div><div class="line"></div><div class="line">const int maxn = 1e6 + 5;</div><div class="line"></div><div class="line">struct seg</div><div class="line">&#123;</div><div class="line">	int l, r;</div><div class="line">	int min, max, sum;</div><div class="line">	seg()&#123; min = INT_MAX; max = INT_MIN; sum = 0; &#125;</div><div class="line">	int lazy;</div><div class="line">&#125;ST[maxn &lt;&lt; 2];</div><div class="line"></div><div class="line">void push_up(int i)</div><div class="line">&#123;</div><div class="line">	ST[i].min = min(ST[lson(i)].min, ST[rson(i)].min);</div><div class="line">	ST[i].max = max(ST[lson(i)].max, ST[rson(i)].max);</div><div class="line">	ST[i].sum = ST[lson(i)].sum + ST[rson(i)].sum;</div><div class="line">&#125;</div><div class="line"></div><div class="line">void build(int i, int l, int r)</div><div class="line">&#123;</div><div class="line">	ST[i].l = l; ST[i].r = r; ST[i].lazy = 0;</div><div class="line">	if (l == r)</div><div class="line">	&#123;</div><div class="line">		int val; scanf("%d", &amp;val);</div><div class="line">		ST[i].min = val;</div><div class="line">		ST[i].max = val;</div><div class="line">		ST[i].sum = val;</div><div class="line">		return;</div><div class="line">	&#125;</div><div class="line">	int m = mid(l, r);</div><div class="line">	build(lson(i), l, m);</div><div class="line">	build(rson(i), m + 1, r);</div><div class="line">	push_up(i);</div><div class="line">&#125;</div><div class="line"></div><div class="line">void query(int i, int l, int r,seg &amp;s)</div><div class="line">&#123;</div><div class="line">	if (ST[i].l &gt;= l&amp;&amp;ST[i].r &lt;= r)</div><div class="line">	&#123;</div><div class="line">		s.min = min(s.min,ST[i].min);</div><div class="line">		s.max = max(s.max,ST[i].max);</div><div class="line">		s.sum += ST[i].sum;</div><div class="line">		return;</div><div class="line">	&#125;</div><div class="line">	int m = mid(ST[i].l, ST[i].r);</div><div class="line">	if(l&gt;m)query(rson(i), l,r,s);//查询区间位于右子树</div><div class="line">	else if(r&lt;=m)query(lson(i),l,r,s);//查询区间位于左子树</div><div class="line">	else</div><div class="line">	&#123;</div><div class="line">		query(lson(i), l, m, s);</div><div class="line">		query(rson(i),m+1,r,s);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">void update_point(int i, int l, int r, int id, int val)</div><div class="line">&#123;</div><div class="line">	if (l == r)</div><div class="line">	&#123;</div><div class="line">		ST[i].min = val;</div><div class="line">		ST[i].max = val;</div><div class="line">		ST[i].sum = val;</div><div class="line">		return;</div><div class="line">	&#125;</div><div class="line">	if (id&lt;=mid(l,r))update_point(lson(i), l, mid(l, r), id, val);</div><div class="line">	else update_point(rson(i), mid(l, r) + 1, r, id, val);</div><div class="line">	push_up(i);</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">int N, Q;</div><div class="line">int main()</div><div class="line">&#123;</div><div class="line">	//freopen("1077.txt","r",stdin);</div><div class="line">	scanf("%d\n", &amp;N);</div><div class="line">	build(1, 1, N);</div><div class="line">	scanf("%d\n", &amp;Q);</div><div class="line">	while (Q--)</div><div class="line">	&#123;</div><div class="line">		int o, x, y; scanf("%d%d%d", &amp;o, &amp;x, &amp;y);</div><div class="line">		if (o)update_point(1, 1, N, x, y);</div><div class="line">		else</div><div class="line">		&#123;</div><div class="line">			seg s; query(1, x, y, s);</div><div class="line">			printf("%d\n", s.min);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="区间更新"><a href="#区间更新" class="headerlink" title="区间更新"></a>区间更新</h4><p>线段树的区间修改也是将区间分成子区间，但是要加一个标记，称作懒惰标记。<br><strong>标记的含义：</strong><br>本节点的统计信息已经根据标记更新过了，但是本节点的子节点仍需要进行更新<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div></pre></td><td class="code"><pre><div class="line">//#include&lt;bits/stdc++.h&gt;</div><div class="line">#include&lt;iostream&gt;</div><div class="line">#include&lt;algorithm&gt;</div><div class="line">using namespace std;</div><div class="line"></div><div class="line">#define mid(l,r) ((l+r)&gt;&gt;1)</div><div class="line">#define lson(i) (i&lt;&lt;1)</div><div class="line">#define rson(i) ((i&lt;&lt;1)|1)</div><div class="line"></div><div class="line">const int maxn = 1e5 + 5;</div><div class="line"></div><div class="line">struct seg&#123;</div><div class="line">	int l, r;</div><div class="line">	int min, sum;</div><div class="line">	bool set;</div><div class="line">	seg()&#123; min = INT_MAX; sum = 0; set = false; &#125;</div><div class="line">	seg(int _l,int _r,int _min, int _sum, bool _set)&#123;</div><div class="line">		l = _l;</div><div class="line">		r = _r;</div><div class="line">		min = _min;</div><div class="line">		sum = _sum;</div><div class="line">		set = _set;</div><div class="line">	&#125;</div><div class="line">&#125;ST[maxn &lt;&lt; 2];</div><div class="line"></div><div class="line">void push_up(int i)&#123;</div><div class="line">	ST[i].min = min(ST[lson(i)].min,ST[rson(i)].min);</div><div class="line">	ST[i].sum = ST[lson(i)].sum + ST[rson(i)].sum;</div><div class="line">&#125;</div><div class="line">void push_down(seg parent, seg &amp;child, int w)&#123;</div><div class="line">	int val = parent.min;</div><div class="line">	if (parent.set)child = seg(child.l, child.r, val, w*val, true);</div><div class="line">&#125;</div><div class="line">void push_down(int i, int w)&#123;</div><div class="line">	push_down(ST[i], ST[lson(i)], (w + 1) &gt;&gt; 1);</div><div class="line">	push_down(ST[i], ST[rson(i)], w &gt;&gt; 1);</div><div class="line">	ST[i].set = false;</div><div class="line">&#125;</div><div class="line">void build(int i, int l, int r)&#123;</div><div class="line">	ST[i].l = l; ST[i].r = r;</div><div class="line">	if (l == r)&#123;</div><div class="line">		int val; scanf("%d", &amp;val);</div><div class="line">		ST[i].min = val;</div><div class="line">		ST[i].sum = val;</div><div class="line">		return;</div><div class="line">	&#125;</div><div class="line">	build(lson(i), l, mid(l, r));</div><div class="line">	build(rson(i), mid(l, r) + 1, r);</div><div class="line">	push_up(i);</div><div class="line">&#125;</div><div class="line">void query(int i, int l, int r, seg &amp;s)&#123;</div><div class="line">	if (l &lt;= ST[i].l&amp;&amp;ST[i].r &lt;= r)&#123;</div><div class="line">		s.min = min(s.min, ST[i].min);</div><div class="line">		s.sum += ST[i].sum;</div><div class="line">		return;</div><div class="line">	&#125;</div><div class="line">	push_down(i, ST[i].r - ST[i].l + 1);</div><div class="line">	int m = mid(ST[i].l, ST[i].r);</div><div class="line">	if (r &lt;= m)query(lson(i), l, r, s);</div><div class="line">	else if (l&gt;m)query(rson(i), l, r, s);</div><div class="line">	else&#123;</div><div class="line">		query(lson(i), l, m, s);</div><div class="line">		query(rson(i), m + 1, r, s);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line">void update(int i, int l, int r, int val)&#123;</div><div class="line">	if (l &lt;= ST[i].l&amp;&amp;ST[i].r &lt;= r)&#123;</div><div class="line">		push_down(seg(0,0,val, 0, true), ST[i], ST[i].r - ST[i].l + 1);</div><div class="line">		return;</div><div class="line">	&#125;</div><div class="line">	push_down(i, ST[i].r - ST[i].l + 1);</div><div class="line">	int m = mid(ST[i].l, ST[i].r);</div><div class="line">	if (r &lt;= m)update(lson(i), l, r, val);</div><div class="line">	else if (l&gt;m)update(rson(i), l, r, val);</div><div class="line">	else&#123;</div><div class="line">		update(lson(i), l, m, val);</div><div class="line">		update(rson(i), m + 1, r, val);</div><div class="line">	&#125;</div><div class="line">	push_up(i);</div><div class="line">&#125;</div><div class="line">int N, Q;</div><div class="line">int main()&#123;</div><div class="line">	freopen("1078.txt","r",stdin);</div><div class="line">	scanf("%d", &amp;N);</div><div class="line">	build(1, 1, N);</div><div class="line">	scanf("%d", &amp;Q);</div><div class="line">	while (Q--)&#123;</div><div class="line">		int o, x, y, v; scanf("%d%d%d", &amp;o, &amp;x, &amp;y);</div><div class="line">		if (o)&#123;</div><div class="line">			scanf("%d", &amp;v);</div><div class="line">			update(1, x, y, v);</div><div class="line">		&#125;</div><div class="line">		else&#123;</div><div class="line">			seg s;</div><div class="line">			query(1, x, y, s);</div><div class="line">			printf("%d\n", s.sum);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="最终模板"><a href="#最终模板" class="headerlink" title="最终模板"></a>最终模板</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div></pre></td><td class="code"><pre><div class="line">#include&lt;iostream&gt;</div><div class="line">#include&lt;algorithm&gt;</div><div class="line">#include&lt;bits/stdc++.h&gt;</div><div class="line">using namespace std;</div><div class="line"></div><div class="line">#define mid(l,r) ((l+r)&gt;&gt;1)</div><div class="line">#define lson(i) (i&lt;&lt;1)</div><div class="line">#define rson(i) ((i&lt;&lt;1)|1)</div><div class="line"></div><div class="line">const int maxn = 1e5 + 5;</div><div class="line"></div><div class="line">struct seg&#123;</div><div class="line">	int l, r;</div><div class="line">	int min, max, sum;</div><div class="line">	int add;</div><div class="line">	bool set;</div><div class="line">	seg()&#123; min = INT_MAX; max = INT_MIN; sum = 0; add = 0; set = false; &#125;</div><div class="line">	seg(int _l,int _r,int _min,int _max,int _sum,int _add,int _set)&#123;</div><div class="line">		l = _l; r = _r;</div><div class="line">		min = _min; max = _max; sum =_sum;</div><div class="line">		add = _add; set = _set;</div><div class="line">	&#125;</div><div class="line">&#125;ST[maxn&lt;&lt;2];</div><div class="line"></div><div class="line">void push_up(int i)</div><div class="line">&#123;</div><div class="line">	ST[i].min = min(ST[lson(i)].min,ST[rson(i)].min);</div><div class="line">	ST[i].max = max(ST[lson(i)].max,ST[rson(i)].max);</div><div class="line">	ST[i].sum = ST[lson(i)].sum + ST[rson(i)].sum;</div><div class="line">&#125;</div><div class="line"></div><div class="line">void push_down(seg parent,seg &amp;child,int w)&#123;</div><div class="line">	int val = parent.min, add = parent.add;</div><div class="line">	if (parent.set)child = seg(child.l, child.r, val, val, w*val, 0, true);</div><div class="line">	else if (child.set)child = seg(child.l, child.r, child.min + add, child.max + add, child.sum + w*add, 0, true);</div><div class="line">	else child = seg(child.l, child.r, child.min + add, child.max + add, child.sum + w*add, child.add + add, false);</div><div class="line">&#125;</div><div class="line"></div><div class="line">void push_down(int i, int w)</div><div class="line">&#123;</div><div class="line">	push_down(ST[i], ST[lson(i)], (w+1)&gt;&gt;1);</div><div class="line">	push_down(ST[i], ST[rson(i)],  w&gt;&gt;1);</div><div class="line">	ST[i].add = 0; ST[i].set = false;</div><div class="line">&#125;</div><div class="line"></div><div class="line">void build(int i, int l, int r)</div><div class="line">&#123;</div><div class="line">	ST[i].l = l; ST[i].r = r;</div><div class="line">	if (l == r)</div><div class="line">	&#123;</div><div class="line">		int val=0;//scanf("%d",&amp;val);</div><div class="line">		ST[i] = seg(l, r, val, val, val, 0, false);</div><div class="line">		return;</div><div class="line">	&#125;</div><div class="line">	int m = mid(l, r);</div><div class="line">	build(lson(i), l, m);</div><div class="line">	build(rson(i),m+1,r);</div><div class="line">	push_up(i);</div><div class="line">&#125;</div><div class="line"></div><div class="line">void query(int i, int l, int r, seg &amp;s)</div><div class="line">&#123;</div><div class="line">	if (l &lt;= ST[i].l&amp;&amp;ST[i].r &lt;= r)</div><div class="line">	&#123;</div><div class="line">		s.min = min(s.min, ST[i].min);</div><div class="line">		s.max = max(s.max, ST[i].max);</div><div class="line">		s.sum += ST[i].sum;</div><div class="line">		return;</div><div class="line">	&#125;</div><div class="line">	push_down(i, ST[i].r - ST[i].l + 1);</div><div class="line">	int m = mid(ST[i].l, ST[i].r);</div><div class="line">	if (r &lt;= m)query(lson(i), l, r, s);</div><div class="line">	else if (l &gt; m)query(rson(i), l, r, s);</div><div class="line">	else&#123;</div><div class="line">		query(lson(i), l, m, s);</div><div class="line">		query(rson(i), m + 1, r, s);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">/*op为0表示加上val,为1表示赋值为val*/</div><div class="line">void update(int i, int l, int r, int val,int op)</div><div class="line">&#123;</div><div class="line">	if (l &lt;= ST[i].l&amp;&amp;ST[i].r &lt;= r)</div><div class="line">	&#123;</div><div class="line">		if (op)push_down(seg(0, 0, val, 0, 0, 0, true), ST[i], ST[i].r - ST[i].l + 1);</div><div class="line">		else push_down(seg(0, 0, 0, 0, 0, val, false), ST[i], ST[i].r - ST[i].l + 1);</div><div class="line">		return;</div><div class="line">	&#125;</div><div class="line">	push_down(i,ST[i].r-ST[i].l+1);</div><div class="line">	int m = mid(ST[i].l,ST[i].r);</div><div class="line">	if (r &lt;= m)update(lson(i), l, r, val, op);</div><div class="line">	else if (l &gt; m)update(rson(i), l, r, val, op);</div><div class="line">	else&#123;</div><div class="line">		update(lson(i),l,m,val,op);</div><div class="line">		update(rson(i), m + 1, r, val, op);</div><div class="line">	&#125;</div><div class="line">	push_up(i);</div><div class="line">&#125;</div><div class="line">int N;</div><div class="line">int main()</div><div class="line">&#123;</div><div class="line">	//freopen("1665.txt","r",stdin);</div><div class="line">	build(1, 1, maxn);</div><div class="line">	scanf("%d\n", &amp;N);</div><div class="line">	while (N--)</div><div class="line">	&#123;</div><div class="line">		int x, y; scanf("%d%d", &amp;x, &amp;y);</div><div class="line">		seg s; query(1, x, y, s);</div><div class="line">		update(1, x, y, s.max + 1, 1);</div><div class="line">		printf("%d\n",s.max+1);</div><div class="line">	&#125;</div><div class="line">	return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/线段树/">线段树</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/08/16/树状数组/" title="树状数组" itemprop="url">树状数组</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2017-08-16T14:36:45.000Z" itemprop="datePublished"> 发表于 2017-08-16</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="树状数组"><a href="#树状数组" class="headerlink" title="树状数组"></a>树状数组</h3><p><strong>适合单点更新的区间求和。</strong><br>树状数组(BIT)是能够在O(log(n))时间内完成下列操作的数据结构。</p>
<ol>
<li>给定i,计算a1+a2+…+ai</li>
<li>给定i和x,执行ai+=x</li>
</ol>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1000</span>;</div><div class="line"><span class="keyword">int</span> BIT[maxn + <span class="number">1</span>];</div><div class="line"><span class="keyword">int</span> n;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> i)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> ans = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span> (i)</div><div class="line">	&#123;</div><div class="line">		ans += BIT[i];</div><div class="line">		i -= (i&amp;-i);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> x)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">while</span> (i &lt;= n)</div><div class="line">	&#123;</div><div class="line">		BIT[i] += x;</div><div class="line">		i += (i&amp;-i);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">bulid</span><span class="params">(<span class="keyword">int</span> a[])</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,x;i&lt;=n;++i)</div><div class="line">    &#123;</div><div class="line">        BIT[i]+=a[i<span class="number">-1</span>];</div><div class="line">        <span class="keyword">if</span>((x=i+(i&amp;<span class="number">-1</span>))&lt;=n)BIT[x]+=BIT[i];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="1-逆序对的个数"><a href="#1-逆序对的个数" class="headerlink" title="1.逆序对的个数"></a>1.逆序对的个数</h3><p>给定一个1~n的排列a1,a2,…an,求an的中逆序对的个数。</p>
<h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>定义一个数组C,每次读入一个a[i]，就将C[a[i]]加1，如果一个比a[i]小的数a[j]在a[i]之前出现了(j<i)，此时c[a[j]]一定大于0，这时c中前a[i]项的和就是满足j<=i,a[j]<=a[i]的个数。所以我们需要一个能够对某项加1，并求前几项的和的数据结构，树状数组就能很好地完成这项任务。 <figure="" class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">10001</span>;</div><div class="line"><span class="keyword">int</span> BIT[maxn];</div><div class="line"><span class="keyword">int</span> n;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> i)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> s=<span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span>(i)</div><div class="line">    &#123;</div><div class="line">        s+=BIT[i];</div><div class="line">        i-=(i&amp;-i);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> s;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> x)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">while</span>(i&lt;=n)</div><div class="line">    &#123;</div><div class="line">        BIT[i]+=x;</div><div class="line">        i+=(i&amp;-i);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> a[])</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">long</span> <span class="keyword">long</span> ans = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i)</div><div class="line">    &#123;</div><div class="line">        add(a[i],<span class="number">1</span>);<span class="comment">//将a[i]出现次数加1</span></div><div class="line">        ans+=i+<span class="number">1</span>-sum(a[i]);<span class="comment">//在a[i]之前出现的数是满足j&lt;=i,a[j]&lt;=a[i]的个数，将总个数减去该数即为逆序对数</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> ans;</div><div class="line">&#125;</div></pre></td></tr></table></i)，此时c[a[j]]一定大于0，这时c中前a[i]项的和就是满足j<=i,a[j]<=a[i]的个数。所以我们需要一个能够对某项加1，并求前几项的和的数据结构，树状数组就能很好地完成这项任务。></p>
<h3 id="树状数组模板"><a href="#树状数组模板" class="headerlink" title="树状数组模板"></a>树状数组模板</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span>+<span class="number">5</span>;</div><div class="line"><span class="keyword">int</span> BIT[maxn];</div><div class="line"><span class="keyword">int</span> n;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">lowbit</span><span class="params">(<span class="keyword">int</span> i)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">return</span> i&amp;(-i);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> x)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">while</span> (i &lt;= n)</div><div class="line">	&#123;</div><div class="line">		BIT[i] += x;</div><div class="line">		i += lowbit(i);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> i)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> ans = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span> (i)</div><div class="line">	&#123;</div><div class="line">		ans += BIT[i];</div><div class="line">		i -= lowbit(i);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> a[])</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>,x; i &lt;= n; ++i)</div><div class="line">	&#123;</div><div class="line">		BIT[i] += a[i - <span class="number">1</span>];</div><div class="line">		<span class="keyword">if</span> ((x = i + lowbit(i)) &lt;= n)BIT[x] += BIT[i];</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/算法/">算法</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/算法/">算法</a><a href="/tags/笔试/">笔试</a><a href="/tags/树状数组/">树状数组</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/08/15/数论基础/" title="数论基础" itemprop="url">数论基础</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2017-08-15T13:08:56.000Z" itemprop="datePublished"> 发表于 2017-08-15</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="数论基础"><a href="#数论基础" class="headerlink" title="数论基础"></a>数论基础</h2><h3 id="1-模"><a href="#1-模" class="headerlink" title="1.模"></a>1.模</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">(a+b)mod(n)=((a)mod(n)+(b)mod(n))mod(n)  </div><div class="line"></div><div class="line">(a-b)mod(n)=((a)mod(n)-(b)mod(n)+n)mod(n)</div><div class="line"></div><div class="line">(a*b)mod(n)=((a)mod(n)*(b)mod(n))mod(n)</div><div class="line"></div><div class="line">(i+m)^&#123;A&#125;(mod\ m)=i^&#123;A&#125;(mod\ m)</div></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">mul_mod</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> n)</span></span></div><div class="line">&#123;</div><div class="line">    a=a%n;</div><div class="line">    b=b%n;</div><div class="line">    <span class="keyword">return</span> ((<span class="keyword">long</span> <span class="keyword">long</span>)a*b%n);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="2-辗转相除法"><a href="#2-辗转相除法" class="headerlink" title="2.辗转相除法"></a>2.辗转相除法</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//ab=gcd(a,b)*lcm(a,b)</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span>(b==<span class="number">0</span>)<span class="keyword">return</span> a;</div><div class="line">    <span class="keyword">return</span> gcd(b,a%b);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="3-同余"><a href="#3-同余" class="headerlink" title="3.同余"></a>3.同余</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">a\ mod\ m=c\ mod \ m =&gt;a\equiv c(mod\ m)</div></pre></td></tr></table></figure>
<h3 id="4-快速幂取模"><a href="#4-快速幂取模" class="headerlink" title="4.快速幂取模"></a>4.快速幂取模</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">a^&#123;b&#125;(mod\ m)</div></pre></td></tr></table></figure>
<p>将b表示成二进制：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">b=p(n-1)2^&#123;n-1&#125;+p(n-2)2^&#123;n-2&#125;+...+p(0)</div></pre></td></tr></table></figure></p>
<p>所以：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">a^&#123;b&#125;=a^&#123;p(n-1)2^&#123;n-1&#125;+p(n-2)2^&#123;n-2&#125;+...+p(0)&#125;=a^&#123;p(n-1)2^&#123;n-1&#125;&#125;*a^&#123;p(n-2)2^&#123;n-2&#125;&#125;*...*a^&#123;p(0)&#125;</div></pre></td></tr></table></figure></p>
<p>若p(k)=0,则：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">a^&#123;p(k)2^&#123;k&#125;&#125;=1</div></pre></td></tr></table></figure></p>
<p>若p(k)=1,则：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">a^&#123;2^&#123;k&#125;&#125;=a^&#123;2^&#123;k-1&#125;*2&#125;=(a^&#123;2^&#123;k-1&#125;&#125;)^&#123;2&#125;</div></pre></td></tr></table></figure></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*快速幂取模*/</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">fast_pow_mod</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> n, <span class="keyword">int</span> m)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">long</span> <span class="keyword">long</span> r = <span class="number">1</span>, aa = a;</div><div class="line">	<span class="keyword">while</span> (n)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">if</span> (n &amp; <span class="number">1</span>)r = (r*aa) % m;</div><div class="line">		n &gt;&gt;= <span class="number">1</span>;</div><div class="line">		aa = (aa*aa) % m;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> r;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="5-扩展欧几里得算法"><a href="#5-扩展欧几里得算法" class="headerlink" title="5.扩展欧几里得算法"></a>5.扩展欧几里得算法</h3><blockquote>
<p>扩展欧几里得算法是用来求解满足ax+by=gcd(a,b)的一组解(贝祖等式)。<br>假设x1,y1是这个方程的一组解，即<br>ax1+by1=gcd(a,b)<br>假设x2,y2是方程bx+(a%b)y=gcd(b,a%b)的一组解，即：<br>bx2+(a%b)y2=gcd(b,a%b)<br>因为gcd(a,b)=gcd(b,a%b)<br>所以ax1+by1=bx2+(a-a/bb)y2=ay2+b(x2-a/by2)<br>所以y2=x1,x2-[a/b]y2=y1是方程组的解<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*扩展欧几里得算法*/</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">extgcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> &amp;x,<span class="keyword">int</span> &amp;y)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> d = a;</div><div class="line">	<span class="keyword">if</span> (b==<span class="number">0</span>)</div><div class="line">	&#123;</div><div class="line">		x = <span class="number">1</span>;</div><div class="line">		y = <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">else</span></div><div class="line">	&#123;</div><div class="line">		d = extgcd(b, a%b, y, x);</div><div class="line">		y -= a / b*x;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> d;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/数论/">数论</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/08/05/gBallon/" title="gBallon" itemprop="url">gBallon</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2017-08-05T11:08:56.000Z" itemprop="datePublished"> 发表于 2017-08-05</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="gBallon"><a href="#gBallon" class="headerlink" title="gBallon"></a>gBallon</h3><h3 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h3><p><a href="https://code.google.com/codejam/contest/11214486/dashboard#s=p1" target="_blank" rel="external">https://code.google.com/codejam/contest/11214486/dashboard#s=p1</a><br>大意是把气球各自移动到某个高度，使所有气球到达y轴时间最短。</p>
<h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>某些求最值的题目，可以变为判断可不可行+二分搜索，这题我们就可以枚举时间t利用二分搜索解决。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1001</span>;</div><div class="line"><span class="keyword">int</span> N, M, Q;</div><div class="line"><span class="keyword">int</span> v[maxn];</div><div class="line"><span class="keyword">struct</span> Ball</div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> p, h;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">Ball ball[maxn];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">getT</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> h)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">if</span> (h &gt;= M || h &lt; <span class="number">0</span>)<span class="keyword">return</span> inf;</div><div class="line">	<span class="keyword">if</span> (p == <span class="number">0</span>)<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (p*v[h] &gt;= <span class="number">0</span>)<span class="keyword">return</span> inf;</div><div class="line">	<span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">abs</span>(p) / <span class="built_in">abs</span>(v[h]) + (<span class="built_in">abs</span>(p) % <span class="built_in">abs</span>(v[h]) ? <span class="number">1</span> : <span class="number">0</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">C</span><span class="params">(<span class="keyword">int</span> t)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> sum = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">bool</span> flag = <span class="literal">false</span>;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= Q; ++j)</div><div class="line">		&#123;</div><div class="line">			<span class="keyword">if</span> (getT(ball[i].p, ball[i].h + j) &lt;= t || getT(ball[i].p, ball[i].h - j) &lt;= t)</div><div class="line">			&#123;</div><div class="line">				flag = <span class="literal">true</span>;</div><div class="line">				sum += j;</div><div class="line">				<span class="keyword">break</span>;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> (!flag)<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> sum &lt;= Q;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> c)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> l = <span class="number">0</span>; <span class="keyword">int</span> r = inf;</div><div class="line">	<span class="keyword">while</span> (r &gt; l)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">int</span> t = (r + l) / <span class="number">2</span>;</div><div class="line">		<span class="keyword">if</span> (C(t))</div><div class="line">			r = t;</div><div class="line">		<span class="keyword">else</span></div><div class="line">			l = t + <span class="number">1</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (l == inf)</div><div class="line">		prtStr(c);</div><div class="line">	<span class="keyword">else</span></div><div class="line">		prtInt(c, l);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	freopen(<span class="string">"B-large-practice.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">	freopen(<span class="string">"00.out"</span>,<span class="string">"w"</span>,<span class="built_in">stdout</span>);</div><div class="line">	<span class="keyword">int</span> T;</div><div class="line">	<span class="built_in">cin</span> &gt;&gt; T;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; T; ++i)</div><div class="line">	&#123;</div><div class="line">		<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M &gt;&gt; Q;</div><div class="line">		FOR(h, M)<span class="built_in">cin</span> &gt;&gt; v[h];</div><div class="line">		FOR(j, N)</div><div class="line">		&#123;</div><div class="line">			<span class="built_in">cin</span> &gt;&gt; ball[j].p &gt;&gt; ball[j].h;</div><div class="line">		&#125;</div><div class="line">		solve(i+<span class="number">1</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="注"><a href="#注" class="headerlink" title="注"></a>注</h3><p>本题还可以用贪心算法解决，每次尝试改进时间最长的气球，将其移到距离最近的能减少当前时间的高度上，如此循环直至无法改进。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1001</span>;</div><div class="line"><span class="keyword">int</span> N, M, Q;</div><div class="line"><span class="keyword">int</span> v[maxn];</div><div class="line"><span class="keyword">struct</span> Ball</div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> p, h, t;</div><div class="line">	<span class="keyword">int</span> y;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(Ball &amp;b1, Ball &amp;b2)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">return</span> b1.t &gt; b2.t;</div><div class="line">&#125;</div><div class="line">Ball ball[maxn];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">getT</span><span class="params">(<span class="keyword">int</span> p, <span class="keyword">int</span> h)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">if</span> (h &gt;= M || h &lt; <span class="number">0</span>)<span class="keyword">return</span> inf;</div><div class="line">	<span class="keyword">if</span> (p == <span class="number">0</span>)<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (p*v[h] &gt;= <span class="number">0</span>)<span class="keyword">return</span> inf;</div><div class="line">	<span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">abs</span>(p) / <span class="built_in">abs</span>(v[h]) + (<span class="built_in">abs</span>(p) % <span class="built_in">abs</span>(v[h]) ? <span class="number">1</span> : <span class="number">0</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> c)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">bool</span> flag = <span class="literal">true</span>;</div><div class="line">	<span class="keyword">while</span> (Q &amp;&amp; flag)</div><div class="line">	&#123;</div><div class="line">		flag = <span class="literal">false</span>;</div><div class="line">		sort(ball, ball + N, cmp);</div><div class="line">			<span class="keyword">if</span> (ball[<span class="number">0</span>].t &lt;= <span class="number">1</span>)</div><div class="line">				<span class="keyword">break</span>;</div><div class="line">			<span class="keyword">int</span> q = <span class="built_in">abs</span>(ball[<span class="number">0</span>].y - ball[<span class="number">0</span>].h);</div><div class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j&lt;=Q+q; ++j)</div><div class="line">			&#123;</div><div class="line">				<span class="keyword">int</span> t1 = getT(ball[<span class="number">0</span>].p, ball[<span class="number">0</span>].h + j);</div><div class="line">				<span class="keyword">int</span> t2 = getT(ball[<span class="number">0</span>].p, ball[<span class="number">0</span>].h - j);</div><div class="line">				<span class="keyword">if</span> (t1 &lt; ball[<span class="number">0</span>].t)</div><div class="line">				&#123;</div><div class="line">					ball[<span class="number">0</span>].t = t1;</div><div class="line">					flag = <span class="literal">true</span>;</div><div class="line">					Q = Q + q - j;</div><div class="line">					ball[<span class="number">0</span>].y = ball[<span class="number">0</span>].h + j;</div><div class="line">					<span class="keyword">break</span>;</div><div class="line">				&#125;</div><div class="line">				<span class="keyword">if</span> (t2 &lt; ball[<span class="number">0</span>].t)</div><div class="line">				&#123;</div><div class="line">					ball[<span class="number">0</span>].t = t2;		</div><div class="line">					flag = <span class="literal">true</span>;</div><div class="line">					Q = Q + q-j;</div><div class="line">					ball[<span class="number">0</span>].y = ball[<span class="number">0</span>].h - j;</div><div class="line">					<span class="keyword">break</span>;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">	&#125;</div><div class="line">	sort(ball, ball + N, cmp);</div><div class="line">	<span class="keyword">if</span> (ball[<span class="number">0</span>].t == inf)</div><div class="line">		prtStr(c);</div><div class="line">	<span class="keyword">else</span></div><div class="line">		prtInt(c, ball[<span class="number">0</span>].t);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	freopen(<span class="string">"B-large-practice.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">	freopen(<span class="string">"0.out"</span>,<span class="string">"w"</span>,<span class="built_in">stdout</span>);</div><div class="line">	<span class="keyword">int</span> T;</div><div class="line">	<span class="built_in">cin</span> &gt;&gt; T;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; T; ++i)</div><div class="line">	&#123;</div><div class="line">		<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M &gt;&gt; Q;</div><div class="line">		FOR(h, M)<span class="built_in">cin</span> &gt;&gt; v[h];</div><div class="line">		FOR(j, N)</div><div class="line">		&#123;</div><div class="line">			<span class="built_in">cin</span> &gt;&gt; ball[j].p &gt;&gt; ball[j].h;</div><div class="line">			ball[j].t = getT(ball[j].p, ball[j].h);</div><div class="line">			ball[j].y = ball[j].h;</div><div class="line">		&#125;</div><div class="line">		solve(i+<span class="number">1</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/Kickstart-Google/">Kickstart Google</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/08/01/二分搜索/" title="二分搜索" itemprop="url">二分搜索</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2017-08-01T11:24:59.000Z" itemprop="datePublished"> 发表于 2017-08-01</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="二分搜索"><a href="#二分搜索" class="headerlink" title="二分搜索"></a>二分搜索</h2><p>如果问题具有单调有序的性质，则可以使用二分查找来搜索满足题目条件的某个值。</p>
<h3 id="1-从有序数组中查找某个值"><a href="#1-从有序数组中查找某个值" class="headerlink" title="1.从有序数组中查找某个值"></a>1.从有序数组中查找某个值</h3><blockquote>
<p>给定长度为n的单调不降数组a0,a1,…,an-1,求满足ai&gt;=k的最小的i,不存在的时候输出n。</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">lowb</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;A, <span class="keyword">int</span> K)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> l = <span class="number">0</span>, r = A.size();</div><div class="line">	<span class="keyword">while</span> (l &lt; r)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">int</span> mid = (l + r) / <span class="number">2</span>;</div><div class="line">		<span class="keyword">if</span> (A[mid] &gt;= K)<span class="comment">//满足条件</span></div><div class="line">			r = mid;</div><div class="line">		<span class="keyword">else</span></div><div class="line">			l = mid+<span class="number">1</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> l;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p>给定长度为n的单调不降数组a0,a1,…,an-1,求满足ai&lt;=k的最大的i加1,不存在的时候输出-1。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">upb</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp;A, <span class="keyword">int</span> K)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> l = <span class="number">0</span>, r = A.size();</div><div class="line">	<span class="keyword">while</span> (l &lt; r)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">int</span> mid = (l + r) / <span class="number">2</span>;</div><div class="line">		<span class="keyword">if</span> (A[mid] &lt;= K)</div><div class="line">			l = mid + <span class="number">1</span>;</div><div class="line">		<span class="keyword">else</span></div><div class="line">			r = mid;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> r;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
</blockquote>
<p>==注：STL中的low_bound和up_bound实现了相同的功能！==</p>
<h3 id="2-判断某个解是否可行"><a href="#2-判断某个解是否可行" class="headerlink" title="2.判断某个解是否可行"></a>2.判断某个解是否可行</h3><blockquote>
<p>有N根绳子，每根长度为Li,从这N根绳子中切割出K根的话，每根最多能有多长？</p>
</blockquote>
<h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>先将绳子排序，切出的绳子长度不会超过最长的绳子，依次二分绳子长度，看看是否满足K根即可。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> n, k;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">10000</span>;</div><div class="line"><span class="keyword">double</span> L[maxn];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">C</span><span class="params">(<span class="keyword">double</span> m)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> sum = <span class="number">0</span>;</div><div class="line">	rep(i, n)</div><div class="line">	&#123;</div><div class="line">		sum += <span class="keyword">int</span>(L[i] / m);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (sum &gt;= k)</div><div class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">solve</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	sort(L, L + n);</div><div class="line">	<span class="keyword">double</span> l = <span class="number">0</span>, r = L[n - <span class="number">1</span>];</div><div class="line">	<span class="keyword">while</span> (r - l &gt; eps)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">double</span> mid = (l + r) / <span class="number">2</span>;</div><div class="line">		<span class="keyword">if</span> (C(mid))</div><div class="line">			l = mid;</div><div class="line">		<span class="keyword">else</span></div><div class="line">			r = mid;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> l;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="3-最大化最小值"><a href="#3-最大化最小值" class="headerlink" title="3.最大化最小值"></a>3.最大化最小值</h3><blockquote>
<p>农夫 John 建造了一座很长的畜栏，它包括N (2 &lt;= N &lt;= 100,000)个隔间，这些小隔间依次编号为x1,…,xN (0 &lt;= xi &lt;= 1,000,000,000).<br>但是，John的C (2 &lt;= C &lt;= N)头牛们并不喜欢这种布局，而且几头牛放在一个隔间里，他们就要发生争斗。为了不让牛互相伤害。John决定自己给牛分配隔间，使任意两头牛之间的最小距离尽可能的大，那么，这个最大的最小距离是什么呢？</p>
</blockquote>
<h3 id="分析-1"><a href="#分析-1" class="headerlink" title="分析"></a>分析</h3><p>先对舍坐标排序，显然最远距离不会超过第一个和最后一个牛舍的距离，二分距离判断是否可行即可。</p>
<h3 id="代码略"><a href="#代码略" class="headerlink" title="代码略"></a>代码略</h3><h3 id="最大化平均值"><a href="#最大化平均值" class="headerlink" title="最大化平均值"></a>最大化平均值</h3><blockquote>
<p>有N个物品重量和价值分别为Wi和Vi,从中选出K个物品使单位重量的价值最大。</p>
</blockquote>
<h3 id="分析-2"><a href="#分析-2" class="headerlink" title="分析"></a>分析</h3><p>起初我觉得将N个物品按单位价值排序取前K个即可，但是这样不对。正确的做法是令C(x)表示表示可以选择使得单位重量的价值不小于x。因此，原问题变成了求满足条件的最大的x。<br>因为v/w&gt;=x,所以v-x*w&gt;=0,所以可以按照v-x*w进行排序，看前k个的和是否大于等于0即可。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">int</span> n, k;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">10001</span>;</div><div class="line"><span class="keyword">double</span> w[maxn];</div><div class="line"><span class="keyword">double</span> v[maxn];</div><div class="line"><span class="keyword">double</span> p[maxn];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">C</span><span class="params">(<span class="keyword">double</span> x)</span></span></div><div class="line">&#123;</div><div class="line">	rep(i, n)</div><div class="line">		p[i] = v[i] - w[i] * x;</div><div class="line">	sort(p, p + n, greater&lt;<span class="keyword">double</span>&gt;());</div><div class="line">	<span class="keyword">double</span> sum = <span class="number">0</span>;</div><div class="line">	rep(i, k)</div><div class="line">		sum += p[i];</div><div class="line">	<span class="keyword">return</span> sum &gt;= <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">solve</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">double</span> l = <span class="number">0</span>, r = inf;</div><div class="line">	<span class="keyword">while</span> (r-l&gt;eps)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">double</span> mid = (r + l) / <span class="number">2</span>;</div><div class="line">		<span class="keyword">if</span> (C(mid))</div><div class="line">			l = mid;</div><div class="line">		<span class="keyword">else</span></div><div class="line">			r = mid;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> l;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/算法-挑战程序设计竞赛/">算法 挑战程序设计竞赛</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/07/27/leetcode Stranger Printer/" title="leetcode Coin Path" itemprop="url">leetcode Coin Path</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2017-07-27T12:37:13.000Z" itemprop="datePublished"> 发表于 2017-07-27</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><p>here is a strange printer with the following two special requirements:</p>
<p>The printer can only print a sequence of the same character each time.<br>At each turn, the printer can print new characters starting from and ending at any places, and will cover the original existing characters.<br>Given a string consists of lower English letters only, your job is to count the minimum number of turns the printer needed in order to print it.</p>
<p>Example 1:<br>Input: “aaabbb”<br>Output: 2<br>Explanation: Print “aaa” first and then print “bbb”.<br>Example 2:<br>Input: “aba”<br>Output: 2<br>Explanation: Print “aaa” first and then print “b” from the second place of the string, which will cover the existing character ‘a’.<br>Hint: Length of the given string will not exceed 100.</p>
<h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><p>令dp[i][j]表示打印字符串i…j所需要的次数，显然dp[i][j]最多为dp[i+1][j]+1,但是如果i+1…j之间有和s[i]相同的字母，我们打印s[i]时就可以一起打印了。设s[i]==s[k],i+1&lt;=k&lt;=j,则dp[i][k]可以为dp[i][k-1]，综上：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">dp[i][j]=min&#123;1+dp[i+1][j],dp[i][k-1]+dp[k+1][j]|s[i]==s[k]&#125;</div></pre></td></tr></table></figure></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line">#include&lt;iostream&gt;</div><div class="line">#include&lt;stdio.h&gt;</div><div class="line">#include&lt;cmath&gt;</div><div class="line">#include&lt;algorithm&gt;</div><div class="line">#include&lt;functional&gt;</div><div class="line">#include&lt;string&gt;</div><div class="line">#include&lt;cstring&gt;</div><div class="line">#include&lt;string.h&gt;</div><div class="line">#include&lt;map&gt;</div><div class="line">#include&lt;queue&gt;</div><div class="line">#include&lt;stack&gt;</div><div class="line">#include&lt;list&gt;</div><div class="line">#include&lt;cctype&gt;</div><div class="line">#include&lt;fstream&gt;</div><div class="line">#include&lt;sstream&gt;</div><div class="line">#include&lt;iomanip&gt;</div><div class="line">#include&lt;set&gt;</div><div class="line">#include&lt;bitset&gt;</div><div class="line">#include&lt;vector&gt;</div><div class="line">#include&lt;cstdlib&gt;</div><div class="line">#include&lt;time.h&gt;</div><div class="line"></div><div class="line">using namespace std;</div><div class="line"></div><div class="line">#define mem(x,a) memset(x,a,sizeof(x))</div><div class="line">#define FOR(i, a, b) for (int i=a; i&lt;b; i++)</div><div class="line">#define FOR(i, a) for (int i=0; i&lt;a; i++)</div><div class="line"></div><div class="line">const int inf = 0x3fffffff;</div><div class="line">const double pi = acos(-1.0);</div><div class="line">const double eps = 1e-8;</div><div class="line">typedef long long ll;</div><div class="line"></div><div class="line">const int maxn = 105;</div><div class="line">int dp[maxn][maxn];</div><div class="line"></div><div class="line">int solve(string s)</div><div class="line">&#123;</div><div class="line">	mem(dp, 0);</div><div class="line">	int n = s.length();</div><div class="line">	if (n == 0)return 0;</div><div class="line">	for (int i = 0; i&lt;n; ++i)dp[i][i] = 1;</div><div class="line">	for (int d = 1; d&lt;n; ++d)</div><div class="line">	&#123;</div><div class="line">		for (int i = 0; i + d&lt;n; ++i)</div><div class="line">		&#123;</div><div class="line">			dp[i][i + d] = dp[i + 1][i + d] + 1;</div><div class="line">			for (int k = i + 1; k &lt;= i + d; ++k)</div><div class="line">			&#123;</div><div class="line">				if (s[i] == s[k])dp[i][i + d] = min(dp[i][i + d], dp[i][k - 1] + dp[k + 1][i + d]);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	return dp[0][n - 1];</div><div class="line">&#125;</div><div class="line"></div><div class="line">class Solution &#123;</div><div class="line">public:</div><div class="line">	int strangePrinter(string s) &#123;</div><div class="line">		return solve(s);</div><div class="line">	&#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/算法-leetcode/">算法 leetcode</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/07/25/leetcode Coin Path/" title="leetcode Coin Path" itemprop="url">leetcode Coin Path</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2017-07-25T11:30:00.000Z" itemprop="datePublished"> 发表于 2017-07-25</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h2><p>LeetCode 656. Coin Path<br>Given an array A (index starts at 1) consisting of N integers: A1, A2, …, AN and an integer B. The integer B denotes that from any place (suppose the index is i) in the array A, you can jump to any one of the place in the array A indexed i+1, i+2, …, i+B if this place can be jumped to. Also, if you step on the index i, you have to pay Ai coins. If Ai is -1, it means you can’t jump to the place indexed i in the array.</p>
<p>Now, you start from the place indexed 1 in the array A, and your aim is to reach the place indexed N using the minimum coins. You need to return the path of indexes (starting from 1 to N) in the array you should take to get to the place indexed N using minimum coins.</p>
<p>If there are multiple paths with the same cost, return the lexicographically smallest such path.</p>
<p>If it’s not possible to reach the place indexed N then you need to return an empty array.  </p>
<p>Example 1:  </p>
<p>Input: [1,2,4,-1,2], 2<br>Output: [1,3,5]<br>Example 2:  </p>
<p>Input: [1,2,4,-1,2], 1<br>Output: []<br>Note:  </p>
<p>Path Pa1, Pa2, …, Pan is lexicographically smaller than Pb1, Pb2, …, Pbm, if and only if at the first i where Pai and Pbi differ, Pai &lt; Pbi; when no such i exists, then n &lt; m.<br>A1 &gt;= 0. A2, …, AN (if exist) will in the range of [-1, 100].<br>Length of A is in the range of [1, 1000].<br>B is in the range of [1, 100].</p>
<h2 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h2><p>令dp[i]表示从i到n的最小代价，则：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">dp[i]=INF if A[i-1]=-1</div><div class="line"></div><div class="line">dp[i]=min(dp[i+k]+A[i+k-1]|1&lt;=k=B,A[i+k-1]!=-1)</div></pre></td></tr></table></figure></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1001</span>;</div><div class="line"><span class="keyword">int</span> dp[maxn];</div><div class="line"></div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; solve(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; &amp;A, <span class="keyword">int</span> B)</div><div class="line">&#123;</div><div class="line">	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; res;</div><div class="line">	<span class="keyword">int</span> n = A.size();</div><div class="line">	<span class="keyword">if</span> (n == <span class="number">1</span>)</div><div class="line">	&#123;</div><div class="line">		res.push_back(<span class="number">1</span>); <span class="keyword">return</span> res;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (A[n - <span class="number">1</span>] == <span class="number">-1</span>)</div><div class="line">		<span class="keyword">return</span> res;</div><div class="line">	mem(dp, <span class="number">0x3f</span>);</div><div class="line">	dp[n] = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = n - <span class="number">1</span>; i &gt;= <span class="number">1</span>; --i)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">if</span> (A[i - <span class="number">1</span>] != <span class="number">-1</span>)</div><div class="line">		&#123;</div><div class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= B; ++j)</div><div class="line">			&#123;</div><div class="line">				<span class="keyword">if</span> (i + j &lt;= n &amp;&amp; A[i + j - <span class="number">1</span>] != <span class="number">-1</span>)</div><div class="line">					dp[i] = min(dp[i], dp[i + j] + A[i + j - <span class="number">1</span>]);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (dp[<span class="number">1</span>] == inf)</div><div class="line">		<span class="keyword">return</span> res;</div><div class="line">	<span class="keyword">int</span> k = <span class="number">1</span>;</div><div class="line">	</div><div class="line">	<span class="keyword">while</span> (k!=n)</div><div class="line">	&#123;</div><div class="line">		res.push_back(k);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= B; ++j)</div><div class="line">		&#123;</div><div class="line">			<span class="keyword">if</span> (dp[k] == dp[k + j] + A[k + j - <span class="number">1</span>])</div><div class="line">			&#123;</div><div class="line">				k = k + j;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	res.push_back(n);</div><div class="line">	<span class="keyword">return</span> res;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/算法-leetcode/">算法 leetcode</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/07/23/Magical Thinking/" title="Magical Thinking" itemprop="url">Magical Thinking</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2017-07-23T10:15:16.000Z" itemprop="datePublished"> 发表于 2017-07-23</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="Magical-Thinking-状态转移DP"><a href="#Magical-Thinking-状态转移DP" class="headerlink" title="Magical Thinking:状态转移DP"></a>Magical Thinking:状态转移DP</h2><p><a href="https://codejam.withgoogle.com/codejam/contest/4344486/dashboard#s=p2&amp;a=2" target="_blank" rel="external">https://codejam.withgoogle.com/codejam/contest/4344486/dashboard#s=p2&amp;a=2</a></p>
<h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>初始情况下，N+1个人的得分均为0。假如N=2,令F[i][j][k]表示前k道题第1个朋友恰好i分，第2个朋友恰好得了j分时我所能得到的最大的分数。<br>则：  </p>
<blockquote>
<p>F[i][j][k] = F[i][j][k-1]   //第k道题三人均答错<br>F[i][j][k] = F[i][j][k-1]+1  //第k道他俩答错我答对<br>F[i][j][k] = F[i-1][j][k-1]  //第k道只有第1位朋友答对<br>F[i][j][k] = F[i][j-1][k-1]  //第k道只有第2位朋友答对<br>F[i][j][k] = F[i-1][j][k-1]+1  //第k道我和第1位朋友答对<br>F[i][j][k] = F[i][j-1][k-1]+1  //第k道我和第2位朋友答对<br>F[i][j][k] = F[i-1][j-1][k-1]  //第k道他俩答对我答错<br>F[i][j][k] = F[i-1][j-1][k-1]+1  //第k道三人均答对<br>综上，F取上面最大值</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</div><div class="line"><span class="built_in">string</span> my;</div><div class="line"><span class="built_in">string</span> fr1;</div><div class="line"><span class="built_in">string</span> fr2;</div><div class="line"><span class="keyword">int</span> s1;</div><div class="line"><span class="keyword">int</span> s2;</div><div class="line"><span class="keyword">int</span> F[<span class="number">51</span>][<span class="number">51</span>];</div><div class="line"><span class="keyword">int</span> M[<span class="number">51</span>][<span class="number">51</span>][<span class="number">51</span>];</div><div class="line"><span class="keyword">struct</span> State</div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> s0, s1, s2;</div><div class="line">	State()&#123;&#125;;</div><div class="line">	State(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c)</div><div class="line">	&#123;</div><div class="line">		s0 = a; s1=b; s2=c;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> State &amp;s)<span class="keyword">const</span></div><div class="line">	&#123;</div><div class="line">		<span class="keyword">if</span> (s0 != s.s0)</div><div class="line">			<span class="keyword">return</span> s0 &lt; s.s0;</div><div class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (s1 != s.s1)</div><div class="line">			<span class="keyword">return</span> s1 &lt; s.s1;</div><div class="line">		<span class="keyword">else</span></div><div class="line">			<span class="keyword">return</span> s2 &lt; s.s2;</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> c, <span class="keyword">int</span> N, <span class="keyword">int</span> Q)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">if</span> (N == <span class="number">1</span>)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">int</span> same = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; Q; ++i)</div><div class="line">		&#123;</div><div class="line">			<span class="keyword">if</span> (my[i] == fr1[i])</div><div class="line">				++same;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> Q - <span class="built_in">abs</span>(s1 - same);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">else</span></div><div class="line">	&#123;</div><div class="line">		<span class="built_in">memset</span>(M, <span class="number">-1</span>, <span class="keyword">sizeof</span>(M));</div><div class="line">		M[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; Q; ++k)</div><div class="line">		&#123;</div><div class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= k; ++i)</div><div class="line">			&#123;</div><div class="line">				<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= k; ++j)</div><div class="line">				&#123;</div><div class="line">					<span class="keyword">if</span> (M[k][i][j] &gt;= <span class="number">0</span>)</div><div class="line">					&#123;</div><div class="line">						<span class="comment">//正确答案为'T'</span></div><div class="line">						<span class="keyword">int</span> a = (fr1[k] == <span class="string">'T'</span> ? <span class="number">1</span> : <span class="number">0</span>);</div><div class="line">						<span class="keyword">int</span> b = (fr2[k] == <span class="string">'T'</span> ? <span class="number">1</span> : <span class="number">0</span>);</div><div class="line">						<span class="keyword">int</span> c = (my[k] == <span class="string">'T'</span> ? <span class="number">1</span> : <span class="number">0</span>);</div><div class="line">						M[k + <span class="number">1</span>][i + a][j + b] = max(M[k + <span class="number">1</span>][i + a][j + b],M[k][i][j]+c);</div><div class="line">						<span class="comment">//正确答案为'F'</span></div><div class="line">						a = (fr1[k] == <span class="string">'F'</span> ? <span class="number">1</span> : <span class="number">0</span>);</div><div class="line">						b = (fr2[k] == <span class="string">'F'</span> ? <span class="number">1</span> : <span class="number">0</span>);</div><div class="line">						c = (my[k] == <span class="string">'F'</span> ? <span class="number">1</span> : <span class="number">0</span>);</div><div class="line">						M[k + <span class="number">1</span>][i + a][j + b] = max(M[k + <span class="number">1</span>][i + a][j + b], M[k][i][j] + c);</div><div class="line">					&#125;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> M[Q][s1][s2];</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	freopen(<span class="string">"C-large-practice.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</div><div class="line">	freopen(<span class="string">"C-large-practice.out"</span>,<span class="string">"w"</span>,<span class="built_in">stdout</span>);</div><div class="line">	<span class="keyword">int</span> T;</div><div class="line">	<span class="built_in">cin</span> &gt;&gt; T;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; T; ++i)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">int</span> N, Q;</div><div class="line">		<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; Q;</div><div class="line">		<span class="keyword">if</span> (N == <span class="number">1</span>)</div><div class="line">		&#123;</div><div class="line">			<span class="built_in">cin</span> &gt;&gt; fr1;</div><div class="line">			<span class="built_in">cin</span> &gt;&gt; my;</div><div class="line">			<span class="built_in">cin</span> &gt;&gt; s1;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span></div><div class="line">		&#123;</div><div class="line">			<span class="built_in">cin</span> &gt;&gt; fr1;</div><div class="line">			<span class="built_in">cin</span> &gt;&gt; fr2;</div><div class="line">			<span class="built_in">cin</span> &gt;&gt; my;</div><div class="line">			<span class="built_in">cin</span> &gt;&gt; s1 &gt;&gt; s2;</div><div class="line">		&#125;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"Case #%d: %d\n"</span>,i+<span class="number">1</span>,solve(i + <span class="number">1</span>, N, Q));</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/Kickstart-Google/">Kickstart Google</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/07/21/GoSightseeing/" title="GoSightseeing" itemprop="url">GoSightseeing</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2017-07-21T04:32:11.000Z" itemprop="datePublished"> 发表于 2017-07-21</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h2 id="GoSightseeing"><a href="#GoSightseeing" class="headerlink" title="GoSightseeing"></a>GoSightseeing</h2><p><a href="https://codejam.withgoogle.com/codejam/contest/8284487/dashboard#s=a&amp;a=0" target="_blank" rel="external">题目</a><a href="https://codejam.withgoogle.com/codejam/contest/8284487/dashboard#s=a&amp;a=0" target="_blank" rel="external">https://codejam.withgoogle.com/codejam/contest/8284487/dashboard#s=a&amp;a=0</a>  </p>
<h3 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h3><blockquote>
<p>从城市1出发依次经过2,3,4…到达城市N,每个城市你可以决定是否参观还是直接等车，参观将花掉Ts时间。不参观的话你可以立即等车，每座城市i都有发往第i+1座城市的班车。起始发车时间为Si,每隔Fi时间发一班车，到达下一座城市将花掉Di时间。问你能否在Tf前到达城市N,如果能，你最多能参观多少座城市？</p>
<h3 id="输入"><a href="#输入" class="headerlink" title="输入"></a>输入</h3><p>The input starts with one line containing one integer T, which is the number of test cases. T test cases follow.<br>Each test case begins with a line containing 3 integers, N, Ts and Tf, representing the number of cities, the time taken for sightseeing in any city, and the latest time you can arrive in city N.<br>This is followed by N - 1 lines. On the i-th line, there are 3 integers, Si, Fi and Di, indicating the start time, frequency, and duration of buses travelling from city i to city i + 1.</p>
<h3 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h3><p>For each test case, output one line containing Case #x: y, where x is the test case number (starting from 1) and y is the maximum number of cities you can go sightseeing in such that you can still arrive at city N by time Tf at the latest. If it is impossible to arrive at city N by time Tf, output Case #x: IMPOSSIBLE.</p>
<h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><p>Input<br>4<br>4 3 12<br>3 2 1<br>6 2 2<br>1 3 2<br>3 2 30<br>1 2 27<br>3 2 1<br>4 1 11<br>2 1 2<br>4 1 5<br>8 2 2<br>5 10 5000<br>14 27 31<br>27 11 44<br>30 8 20<br>2000 4000 3  </p>
</blockquote>
<p>Output<br>Case #1: 2<br>Case #2: 0<br>Case #3: IMPOSSIBLE<br>Case #4: 4</p>
<h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>(1)假设在每座城市Tw时刻开始等车，则等到车的时间为满足Si+xFi&gt;Tw的最小的数。即登车的时间为Tb=Si+ceil((Tw-Si)/Fi)*Fi,到达下一座城市的时间为Te=Tb+Di.你可以立即等车，则等车时刻即为到达时刻，也可以花Ts参观，等车时刻为Te+Ts.我们可以写一个函数计算这一过程。  </p>
<p>(2)首次，如果每到一个城市就立即开始等车，最后到达城市N时，如果能满足Tf要求，则可行，否则为IMPOSSIBLE.  </p>
<p>(3)如果另F[i][j]表示在时间j内前i个城市最多能参观的城市，这就有点类似背包问题，但是由于T的范围较大，复杂度较高。  </p>
<p>(4)在处理背包问题时，如果背包重量范围过大，我们可以采用F[i][j]表示取得价值为j时前i个物品的最小重量。同理，这里我们可以用F[i][j]表示到达第i个城市中参观j个城市所花的最少时间。则:<br>F[i][j]=F[i-1][j-1]+arrive(i-1,F[i-1][j-1]+Ts);//参观第i-1个城市<br>F[i][j]=F[i-1][j]+arrive(i-1,F[i-1][j])//不参观第i-1个城市<br>综上：<br>F[i][j]=min{F[i-1][j-1]+arrive(i-1,F[i-1][j-1]+Ts),F[i][j]=F[i-1][j]+arrive(i-1,F[i-1][j])}<br>初始化:<br>F[1][0]=0,F[1][1…N]=INF;</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> NUM 2000</span></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3f3f3f3f</span>;</div><div class="line"><span class="keyword">int</span> N, Ts, Tf;</div><div class="line"><span class="keyword">int</span> S[NUM + <span class="number">1</span>];</div><div class="line"><span class="keyword">int</span> F[NUM + <span class="number">1</span>];</div><div class="line"><span class="keyword">int</span> D[NUM + <span class="number">1</span>];</div><div class="line"></div><div class="line"><span class="comment">/*在第i座城市t时刻开始等车，到达下一座城市的时间*/</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">arrive</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> t)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> x = max(<span class="number">0</span>,<span class="keyword">int</span>(<span class="built_in">ceil</span>(<span class="keyword">float</span>(t-S[i])/F[i])));</div><div class="line">	<span class="keyword">return</span> S[i] + x*F[i] + D[i];</div><div class="line">&#125;</div><div class="line"><span class="comment">/*</span></div><div class="line">在处理背包问题时，如果背包重量范围过大，我们可以采用F[i][j]表示取得价值为j时前i个物品的最小重量。同理，这里我们可以用F[i][j]表示到达第i个城市中参观j个城市所花的最少时间。则:</div><div class="line">F[i][j] = F[i - 1][j - 1] + arrive(i - 1, F[i - 1][j - 1] + Ts);//参观第i-1个城市  </div><div class="line">F[i][j] = F[i - 1][j] + arrive(i - 1, F[i - 1][j])//不参观第i-1个城市</div><div class="line">综上：</div><div class="line">F[i][j] = min&#123; arrive(i - 1, F[i - 1][j - 1] + Ts), arrive(i - 1, F[i - 1][j]) &#125;</div><div class="line">初始化:</div><div class="line">F[1][0] = 0, F[1][1...N] = INF;</div><div class="line">*/</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> c)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> **F = (<span class="keyword">int</span>**)<span class="built_in">malloc</span>((N+<span class="number">1</span>)*<span class="keyword">sizeof</span>(<span class="keyword">int</span>*));</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N + <span class="number">1</span>; ++i)</div><div class="line">	&#123;</div><div class="line">		F[i] = (<span class="keyword">int</span>*)<span class="built_in">malloc</span>((N + <span class="number">1</span>)*<span class="keyword">sizeof</span>(<span class="keyword">int</span>));</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; N + <span class="number">1</span>; ++j)</div><div class="line">			F[i][j] = INF;</div><div class="line">	&#125;</div><div class="line">	<span class="comment">//先看看不参观立即等车需要花多少时间</span></div><div class="line">	F[<span class="number">1</span>][<span class="number">0</span>] = <span class="number">0</span>;</div><div class="line">	<span class="keyword">int</span> Te=<span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; N + <span class="number">1</span>; ++i)</div><div class="line">	&#123;</div><div class="line">		Te = arrive(i - <span class="number">1</span>, Te);</div><div class="line">		F[i][<span class="number">0</span>] = Te;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (F[N][<span class="number">0</span>] &gt; Tf)</div><div class="line">	&#123;</div><div class="line">		<span class="built_in">printf</span>(<span class="string">"Case #%d: IMPOSSIBLE\n"</span>,c);</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="comment">//可行的话开始动态规划</span></div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; N + <span class="number">1</span>; ++i)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; i; ++j)</div><div class="line">		&#123;</div><div class="line">			F[i][j] = min(arrive(i - <span class="number">1</span>, F[i - <span class="number">1</span>][j - <span class="number">1</span>] + Ts), arrive(i - <span class="number">1</span>, F[i - <span class="number">1</span>][j]));</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> n;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">if</span> (F[N][i] &lt;= Tf)</div><div class="line">			n = i;</div><div class="line">		<span class="keyword">else</span></div><div class="line">			<span class="keyword">break</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"Case #%d: %d\n"</span>, c,n);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	freopen(<span class="string">"GoSightseeing.in"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">	freopen(<span class="string">"GoSightseeing.out"</span>,<span class="string">"w"</span>,<span class="built_in">stdout</span>);</div><div class="line">	<span class="keyword">int</span> T;</div><div class="line">	<span class="built_in">cin</span> &gt;&gt; T;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; T; ++i)</div><div class="line">	&#123;</div><div class="line">		<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; Ts &gt;&gt; Tf;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; N; ++j)</div><div class="line">		&#123;</div><div class="line">			<span class="keyword">int</span> s, f, d;</div><div class="line">			<span class="built_in">cin</span> &gt;&gt; s &gt;&gt; f &gt;&gt; d;</div><div class="line">			S[j] = s;</div><div class="line">			F[j] = f;</div><div class="line">			D[j] = d;</div><div class="line">		&#125;</div><div class="line">		solve(i+<span class="number">1</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/Kickstart-Google/">Kickstart Google</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>







  <nav id="page-nav" class="clearfix">
    <a class="extend prev" rel="prev" href="/page/2/"><span></span>Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/4/">Next<span></span></a>
  </nav>

</div>
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  


  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/PAT/" title="PAT">PAT<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Parallel-Studio/" title="Parallel Studio">Parallel Studio<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Python/" title="Python">Python<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/hihocoder/" title="hihocoder">hihocoder<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/生活随笔/" title="生活随笔">生活随笔<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/算法/" title="算法">算法<sup>3</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/算法-leetcode/" title="算法 leetcode">算法 leetcode<sup>9</sup></a></li>
			
		
			
				<li><a href="/tags/算法-动态规划/" title="算法 动态规划">算法 动态规划<sup>8</sup></a></li>
			
		
			
				<li><a href="/tags/算法/" title="算法">算法<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/Python/" title="Python">Python<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/Kickstart-Google/" title="Kickstart Google">Kickstart Google<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/笔试/" title="笔试">笔试<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/C/" title="C">C<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Trie树/" title="Trie树">Trie树<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/PAT/" title="PAT">PAT<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/hihocoder-分治/" title="hihocoder 分治">hihocoder 分治<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Parallel-Studio/" title="Parallel Studio">Parallel Studio<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/ICC/" title="ICC">ICC<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/MKL/" title="MKL">MKL<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/正则表达式/" title="正则表达式">正则表达式<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/图论-欧拉路/" title="图论 欧拉路">图论 欧拉路<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Manacher算法/" title="Manacher算法">Manacher算法<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/KMP算法/" title="KMP算法">KMP算法<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/matplotlib/" title="matplotlib">matplotlib<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/算法-挑战程序设计竞赛/" title="算法 挑战程序设计竞赛">算法 挑战程序设计竞赛<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/二叉搜索树/" title="二叉搜索树">二叉搜索树<sup>1</sup></a></li>
			
		
		</ul>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	
	<div class="social-font" class="clearfix">
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2018 
		
		<a href="/about" target="_blank" title="洛绍川">洛绍川</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>










<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
 </html>
