
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
  
    <title>我是小韩同学</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="洛绍川">
    

    
    <meta name="description" content="code">
<meta property="og:type" content="website">
<meta property="og:title" content="我是小韩同学">
<meta property="og:url" content="http://www.luoshaochuan.com/page/3/index.html">
<meta property="og:site_name" content="我是小韩同学">
<meta property="og:description" content="code">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="我是小韩同学">
<meta name="twitter:description" content="code">

    
    
    
    <link rel="stylesheet" href="/css/style.css"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

  <body>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="我是小韩同学" title="我是小韩同学"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="我是小韩同学">我是小韩同学</a></h1>
				<h2 class="blog-motto"></h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">主页</a></li>
					
						<li><a href="/archives">归档</a></li>
					
						<li><a href="/tags">标签</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:www.luoshaochuan.com">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main">

   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2018/01/21/1671.反转子串/" title="1671.反转子串" itemprop="url">1671.反转子串</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2018-01-21T13:48:13.000Z" itemprop="datePublished"> 发表于 2018-01-21</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="1671-反转子串"><a href="#1671-反转子串" class="headerlink" title="1671 : 反转子串"></a><a href="http://hihocoder.com/problemset/problem/1671" target="_blank" rel="external">1671 : 反转子串</a></h3><h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>栈、互递归、伸展树SplayTree。</p>
<p><strong>递归</strong><br>所谓翻转其实就是反向输出，我们可以定义两个函数Forward和Backward,从Forward开始，每次遇到’(‘就调用另一个函数，Backward每次遇到’)’就调用另一个函数。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;functional&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;list&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cctype&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;fstream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;sstream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iomanip&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;time.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">5e6</span> + <span class="number">5</span>;</div><div class="line"><span class="built_in">string</span> S;</div><div class="line"><span class="keyword">int</span> n;</div><div class="line"><span class="keyword">int</span> match[maxn];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">backward</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">forward</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = l; i &lt;= r; ++i)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">if</span> (S[i] == <span class="string">'('</span>)</div><div class="line">		&#123;</div><div class="line">			backward(i + <span class="number">1</span>, match[i] - <span class="number">1</span>);</div><div class="line">			i = match[i];</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span></div><div class="line">			<span class="built_in">printf</span>(<span class="string">"%c"</span>,S[i]);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">backward</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = r; i&gt;=l; --i)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">if</span> (S[i] == <span class="string">')'</span>)</div><div class="line">		&#123;</div><div class="line">			forward(match[i]+<span class="number">1</span>,i<span class="number">-1</span>);</div><div class="line">			i = match[i];</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span></div><div class="line">			<span class="built_in">printf</span>(<span class="string">"%c"</span>, S[i]);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	freopen(<span class="string">"4.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</div><div class="line">	<span class="built_in">cin</span> &gt;&gt; S;</div><div class="line">	n = S.length();</div><div class="line">	<span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt; st;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i)&#123;</div><div class="line">		<span class="keyword">if</span> (S[i] == <span class="string">'('</span>)st.push(i);</div><div class="line">		<span class="keyword">else</span> <span class="keyword">if</span> (S[i] == <span class="string">')'</span>)&#123;</div><div class="line">			match[st.top()] = i;</div><div class="line">			match[i] = st.top();</div><div class="line">			st.pop();</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	forward(<span class="number">0</span>, n - <span class="number">1</span>);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/算法/">算法</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2018/01/20/1663.双阶乘的末尾数字/" title="1663.双阶乘的末尾数字" itemprop="url">1663.双阶乘的末尾数字</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2018-01-20T13:48:13.000Z" itemprop="datePublished"> 发表于 2018-01-20</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="1663-双阶乘的末尾数字"><a href="#1663-双阶乘的末尾数字" class="headerlink" title="1663.双阶乘的末尾数字"></a><a href="http://hihocoder.com/problemset/problem/1663" target="_blank" rel="external">1663.双阶乘的末尾数字</a></h3><h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>找规律题。<br>假设x为偶数，则x个位可能为8，6，4，2，0，不管x个位为什么，x,x-2,x-4,x-6,x-8这几个数必有一个数个位为0，这5个数想乘个位必为0。所以只要遍历这几个数即可。奇数同理，5个数以后个位必为5。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> t;<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;t);</div><div class="line">    <span class="keyword">while</span>(t--)</div><div class="line">    &#123;</div><div class="line">        ll x,k;</div><div class="line">        <span class="built_in">cin</span>&gt;&gt;x&gt;&gt;k;</div><div class="line">        <span class="keyword">int</span> n=<span class="number">1</span>;</div><div class="line">        <span class="keyword">while</span>(n!=k&amp;&amp;n!=<span class="number">0</span>&amp;&amp;n!=<span class="number">5</span>&amp;&amp;x&gt;<span class="number">0</span>)</div><div class="line">        &#123;</div><div class="line">            n=n*(x%<span class="number">10</span>)%<span class="number">10</span>;</div><div class="line">            x-=<span class="number">2</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(n==k&amp;&amp;x&gt;<span class="number">0</span>)<span class="built_in">cout</span>&lt;&lt;x&lt;&lt;<span class="built_in">endl</span>;</div><div class="line">        <span class="keyword">else</span> <span class="built_in">cout</span>&lt;&lt;<span class="number">-1</span>&lt;&lt;<span class="built_in">endl</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/算法/">算法</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2018/01/17/1643.最小换乘/" title="1643.最小换乘" itemprop="url">1643.最小换乘</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2018-01-17T13:48:13.000Z" itemprop="datePublished"> 发表于 2018-01-17</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="1643-最小换乘"><a href="#1643-最小换乘" class="headerlink" title="1643.最小换乘"></a><a href="http://hihocoder.com/problemset/problem/1643" target="_blank" rel="external">1643.最小换乘</a></h3><h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>二分图，最短路。广度优先搜索。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;functional&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;list&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cctype&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;fstream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;sstream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iomanip&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;time.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> CNT = <span class="number">5e4</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">5e6</span> + <span class="number">5e4</span> + <span class="number">5</span>;</div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G[maxn];</div><div class="line"><span class="keyword">bool</span> vis[maxn];</div><div class="line"><span class="keyword">int</span> dis[maxn];</div><div class="line"><span class="keyword">int</span> N, S, E;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	freopen(<span class="string">"1643.txt"</span>,<span class="string">"r"</span>,<span class="built_in">stdin</span>);</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>, &amp;N, &amp;S, &amp;E);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i&lt;N; ++i)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">int</span> k; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;k);</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j&lt;k; ++j)</div><div class="line">		&#123;</div><div class="line">			<span class="keyword">int</span> x; <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x);</div><div class="line">			G[i].push_back(CNT + x);</div><div class="line">			G[CNT + x].push_back(i);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	S = CNT + S; E = CNT + E;</div><div class="line">	<span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; que;</div><div class="line">	que.push(S);</div><div class="line">	vis[S] = <span class="literal">true</span>; dis[S] = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span> (!que.empty())</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">int</span> top = que.front();</div><div class="line">		que.pop();</div><div class="line">		<span class="keyword">if</span> (top == E)<span class="keyword">break</span>;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">auto</span> u : G[top])</div><div class="line">		&#123;</div><div class="line">			<span class="keyword">if</span> (!vis[u])</div><div class="line">			&#123;</div><div class="line">				vis[u] = <span class="literal">true</span>;</div><div class="line">				dis[u] = dis[top] + <span class="number">1</span>;</div><div class="line">				que.push(u);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d"</span>, dis[E] / <span class="number">2</span> - <span class="number">1</span>);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/算法/">算法</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2018/01/14/1642.三角形面积和/" title="1642.三角形面积和" itemprop="url">1642.三角形面积和</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2018-01-14T13:48:13.000Z" itemprop="datePublished"> 发表于 2018-01-14</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="1642-三角形面积和"><a href="#1642-三角形面积和" class="headerlink" title="1642.三角形面积和"></a><a href="http://hihocoder.com/problemset/problem/1642" target="_blank" rel="external">1642.三角形面积和</a></h3><h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>区间排序，维护右端点最大值。能用乘法就别用除法。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;functional&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;list&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cctype&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;fstream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;sstream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iomanip&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;time.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span> + <span class="number">5</span>;</div><div class="line"><span class="keyword">struct</span> tri</div><div class="line">&#123;</div><div class="line">	ll x, y;</div><div class="line">&#125;;</div><div class="line">tri T[maxn];</div><div class="line"><span class="keyword">int</span> n;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d\n"</span>, &amp;n);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i&lt;n; ++i)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">int</span> x, y; <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>, &amp;x, &amp;y);</div><div class="line">		T[i].x = x - y; T[i].y = x + y;</div><div class="line">	&#125;</div><div class="line">	sort(T, T + n, [](tri &amp;t1, tri &amp;t2)&#123;<span class="keyword">if</span> (t1.x != t2.x)<span class="keyword">return</span> t1.x&lt;t2.x; <span class="keyword">else</span> <span class="keyword">return</span> t1.y&gt;t2.y; &#125;);</div><div class="line">	ll ymax = T[<span class="number">0</span>].y;</div><div class="line">	<span class="keyword">double</span> res = (T[<span class="number">0</span>].y - T[<span class="number">0</span>].x)*(T[<span class="number">0</span>].y - T[<span class="number">0</span>].x)*<span class="number">0.25</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i&lt;n; ++i)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">if</span> (T[i].y &lt;= ymax)<span class="keyword">continue</span>;</div><div class="line">		<span class="keyword">if</span> (T[i].x &gt;=ymax)res += (T[i].y - T[i].x)*(T[i].y - T[i].x)*<span class="number">0.25</span>;</div><div class="line">		<span class="keyword">else</span> res += ((T[i].y - T[i].x)*(T[i].y - T[i].x)*<span class="number">0.25</span> - (ymax - T[i].x)*(ymax - T[i].x)*<span class="number">0.25</span>);</div><div class="line">		ymax = T[i].y;</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%.2lf"</span>, res);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div></pre></td></tr></table></figure></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/算法/">算法</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2018/01/11/1644 .完美命名的烦恼/" title="1644 .完美命名的烦恼" itemprop="url">1644 .完美命名的烦恼</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2018-01-11T13:48:13.000Z" itemprop="datePublished"> 发表于 2018-01-11</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="1644-完美命名的烦恼"><a href="#1644-完美命名的烦恼" class="headerlink" title="1644 .完美命名的烦恼"></a><a href="http://hihocoder.com/problemset/problem/1644" target="_blank" rel="external">1644 .完美命名的烦恼</a></h3><h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>建图、欧拉路径<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;functional&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;list&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cctype&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;fstream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;sstream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iomanip&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;time.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> edge</div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> from, to, cost;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span> + <span class="number">5</span>;</div><div class="line"><span class="keyword">int</span> din[maxn];</div><div class="line"><span class="keyword">int</span> dout[maxn];</div><div class="line"><span class="keyword">int</span> vis[maxn],vis_num=<span class="number">0</span>;</div><div class="line"><span class="built_in">vector</span>&lt;edge&gt; G[maxn];</div><div class="line"><span class="built_in">map</span>&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt; M;</div><div class="line"><span class="built_in">string</span> DM[maxn];</div><div class="line"><span class="keyword">int</span> N, L, num = <span class="number">0</span>;</div><div class="line"><span class="built_in">string</span> res = <span class="string">""</span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> s)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">if</span> (!vis[s])&#123; vis[s] = <span class="number">1</span>; ++vis_num; &#125;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; G[s].size();++i)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">if</span> (G[s][i].cost == <span class="number">1</span>)</div><div class="line">		&#123;</div><div class="line">			G[s][i].cost = <span class="number">0</span>;</div><div class="line">			dfs(G[s][i].to);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	res = DM[s].back() + res;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	freopen(<span class="string">"1644.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</div><div class="line">	<span class="built_in">cin</span> &gt;&gt; N;</div><div class="line">	<span class="comment">/*建图*/</span></div><div class="line">	<span class="keyword">int</span> mask = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</div><div class="line">	&#123;</div><div class="line">		<span class="built_in">string</span> word,pref,suff; <span class="built_in">cin</span> &gt;&gt; word;</div><div class="line">		L = word.length();</div><div class="line">		<span class="keyword">if</span> (L&gt;<span class="number">1</span>)</div><div class="line">		&#123;</div><div class="line">			pref = word.substr(<span class="number">0</span>, L<span class="number">-1</span>); suff = word.substr(<span class="number">1</span>, L<span class="number">-1</span>);</div><div class="line">			<span class="keyword">if</span> (M.count(pref) == <span class="number">0</span>)&#123; M[pref] = ++num; DM[num] = pref; &#125;</div><div class="line">			<span class="keyword">if</span> (M.count(suff) == <span class="number">0</span>)&#123; M[suff] = ++num; DM[num] = suff; &#125;</div><div class="line">			++dout[M[pref]]; ++din[M[suff]];</div><div class="line">			G[M[pref]].push_back(edge&#123; M[pref], M[suff], <span class="number">1</span> &#125;);</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span></div><div class="line">		&#123;</div><div class="line">			mask = <span class="number">1</span>;</div><div class="line">			<span class="built_in">cout</span> &lt;&lt; word;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (mask)<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">	<span class="comment">/*判别欧拉路径*/</span></div><div class="line">	<span class="keyword">int</span> s = <span class="number">0</span>, t = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;=num; ++i)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">if</span> (din[i] != dout[i])</div><div class="line">		&#123;</div><div class="line">			<span class="keyword">if</span> (!s&amp;&amp; dout[i] - din[i] == <span class="number">1</span>)&#123; s = i; <span class="keyword">continue</span>; &#125;</div><div class="line">			<span class="keyword">if</span> (!t&amp;&amp; din[i] - dout[i] == <span class="number">1</span>)&#123; t = i; <span class="keyword">continue</span>;&#125;</div><div class="line">			<span class="built_in">cout</span> &lt;&lt; <span class="string">"NO"</span>; <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="comment">/*寻找欧拉路径*/</span></div><div class="line">	<span class="keyword">if</span> (!s&amp;&amp; !t)&#123;</div><div class="line">		dfs(<span class="number">1</span>); </div><div class="line">		res = DM[<span class="number">1</span>].substr(<span class="number">0</span>, L - <span class="number">2</span>) + res;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (s&amp;&amp;t)&#123;</div><div class="line">		dfs(s);</div><div class="line">		res = DM[s].substr(<span class="number">0</span>, L - <span class="number">2</span>) + res;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">else</span> res = <span class="string">"NO"</span>;</div><div class="line">	<span class="keyword">if</span> (vis_num != num)&#123; <span class="built_in">cout</span> &lt;&lt; <span class="string">"NO"</span>; <span class="keyword">return</span> <span class="number">0</span>; &#125;</div><div class="line">	<span class="built_in">cout</span> &lt;&lt; res &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/算法/">算法</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2018/01/08/1654.XY游戏/" title="1654.XY游戏" itemprop="url">1654.XY游戏</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2018-01-08T13:48:13.000Z" itemprop="datePublished"> 发表于 2018-01-08</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>本题的难点在于如何保存状态，将一个状态看做一个长度为16的字符串，然后用set保存。深搜/宽搜即可。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;functional&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;list&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cctype&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;fstream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;sstream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iomanip&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;time.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;unordered_set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;unordered_map&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; b;</div><div class="line"><span class="built_in">unordered_map</span>&lt;<span class="built_in">string</span>,<span class="keyword">int</span>&gt; states;</div><div class="line"><span class="keyword">int</span> dx[<span class="number">4</span>] = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>,<span class="number">-1</span> &#125;;</div><div class="line"><span class="keyword">int</span> dy[<span class="number">4</span>] = &#123;<span class="number">1</span>, <span class="number">0</span>,<span class="number">-1</span>,<span class="number">0</span>&#125;;</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; &amp;b)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">if</span> (b[i][<span class="number">0</span>] == <span class="string">'X'</span>&amp;&amp;b[i][<span class="number">1</span>] == <span class="string">'X'</span>&amp;&amp;b[i][<span class="number">2</span>] == <span class="string">'X'</span>&amp;&amp;b[i][<span class="number">3</span>] == <span class="string">'X'</span>)</div><div class="line">			<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">		<span class="keyword">if</span> (b[i][<span class="number">0</span>] == <span class="string">'Y'</span>&amp;&amp;b[i][<span class="number">1</span>] == <span class="string">'Y'</span>&amp;&amp;b[i][<span class="number">2</span>] == <span class="string">'Y'</span>&amp;&amp;b[i][<span class="number">3</span>] == <span class="string">'Y'</span>)</div><div class="line">			<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">		<span class="keyword">if</span> (b[<span class="number">0</span>][i] == <span class="string">'X'</span>&amp;&amp;b[<span class="number">1</span>][i] == <span class="string">'X'</span>&amp;&amp;b[<span class="number">2</span>][i] == <span class="string">'X'</span>&amp;&amp;b[<span class="number">3</span>][i] == <span class="string">'X'</span>)</div><div class="line">			<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">		<span class="keyword">if</span> (b[<span class="number">0</span>][i] == <span class="string">'Y'</span>&amp;&amp;b[<span class="number">1</span>][i] == <span class="string">'Y'</span>&amp;&amp;b[<span class="number">2</span>][i] == <span class="string">'Y'</span>&amp;&amp;b[<span class="number">3</span>][i] == <span class="string">'Y'</span>)</div><div class="line">			<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (b[<span class="number">0</span>][<span class="number">0</span>]==<span class="string">'X'</span>&amp;&amp; b[<span class="number">1</span>][<span class="number">1</span>] == <span class="string">'X'</span>&amp;&amp; b[<span class="number">2</span>][<span class="number">2</span>] == <span class="string">'X'</span> &amp;&amp;b[<span class="number">3</span>][<span class="number">3</span>] == <span class="string">'X'</span>)<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">	<span class="keyword">if</span> (b[<span class="number">0</span>][<span class="number">0</span>] == <span class="string">'Y'</span>&amp;&amp; b[<span class="number">1</span>][<span class="number">1</span>] == <span class="string">'Y'</span>&amp;&amp; b[<span class="number">2</span>][<span class="number">2</span>] == <span class="string">'Y'</span> &amp;&amp;b[<span class="number">3</span>][<span class="number">3</span>] == <span class="string">'Y'</span>)<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">	<span class="keyword">if</span> (b[<span class="number">0</span>][<span class="number">3</span>] == <span class="string">'X'</span>&amp;&amp; b[<span class="number">1</span>][<span class="number">2</span>] == <span class="string">'X'</span>&amp;&amp; b[<span class="number">2</span>][<span class="number">1</span>] == <span class="string">'X'</span> &amp;&amp;b[<span class="number">3</span>][<span class="number">0</span>] == <span class="string">'X'</span>)<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">	<span class="keyword">if</span> (b[<span class="number">0</span>][<span class="number">3</span>] == <span class="string">'Y'</span>&amp;&amp; b[<span class="number">1</span>][<span class="number">2</span>] == <span class="string">'Y'</span>&amp;&amp; b[<span class="number">2</span>][<span class="number">1</span>] == <span class="string">'Y'</span> &amp;&amp;b[<span class="number">3</span>][<span class="number">0</span>] == <span class="string">'Y'</span>)<span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	freopen(<span class="string">"2.txt"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i)</div><div class="line">	&#123;</div><div class="line">		<span class="built_in">string</span> s; <span class="built_in">cin</span> &gt;&gt; s;</div><div class="line">		b.push_back(s);</div><div class="line">	&#125;</div><div class="line">	states[b[<span class="number">0</span>]+b[<span class="number">1</span>]+b[<span class="number">2</span>]+b[<span class="number">3</span>]]=<span class="number">0</span>;</div><div class="line">	<span class="built_in">queue</span>&lt;<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;&gt; que;</div><div class="line">	que.push(b);</div><div class="line">	<span class="keyword">int</span> res = <span class="number">-1</span>;</div><div class="line">	<span class="keyword">while</span> (!que.empty())</div><div class="line">	&#123;</div><div class="line">		<span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; top = que.front();</div><div class="line">		<span class="built_in">string</span> state = top[<span class="number">0</span>] + top[<span class="number">1</span>] + top[<span class="number">2</span>] + top[<span class="number">3</span>];</div><div class="line">		que.pop();</div><div class="line">		<span class="keyword">if</span> (check(top))</div><div class="line">		&#123;</div><div class="line">			res = states[state];</div><div class="line">			<span class="keyword">break</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i)</div><div class="line">		&#123;</div><div class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span>; ++j)</div><div class="line">			&#123;</div><div class="line">				<span class="keyword">if</span> (top[i][j] != <span class="string">'O'</span>)</div><div class="line">				&#123;</div><div class="line">					<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; ++k)</div><div class="line">					&#123;</div><div class="line">						<span class="keyword">int</span> x = i + dx[k], y = j + dy[k];</div><div class="line">						<span class="keyword">if</span> (x &gt;= <span class="number">0</span> &amp;&amp; x &lt; <span class="number">4</span> &amp;&amp; y &gt;= <span class="number">0</span> &amp;&amp; y &lt; <span class="number">4</span> &amp;&amp; top[x][y]==<span class="string">'O'</span>)</div><div class="line">						&#123;</div><div class="line">							swap(top[i][j], top[x][y]);</div><div class="line">							<span class="keyword">if</span> (states.count(top[<span class="number">0</span>] + top[<span class="number">1</span>] + top[<span class="number">2</span>] + top[<span class="number">3</span>]) == <span class="number">0</span>)</div><div class="line">							&#123;</div><div class="line">								states[top[<span class="number">0</span>] + top[<span class="number">1</span>] + top[<span class="number">2</span>] + top[<span class="number">3</span>]] = states[state] + <span class="number">1</span>;</div><div class="line">								que.push(top);</div><div class="line">							&#125;</div><div class="line">							swap(top[i][j], top[x][y]);</div><div class="line">						&#125;</div><div class="line">					&#125;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="built_in">cout</span> &lt;&lt; res &lt;&lt; <span class="built_in">endl</span>;</div><div class="line"></div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/算法/">算法</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2018/01/07/1651.小球染色/" title="1651.小球染色" itemprop="url">1651.小球染色</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2018-01-07T13:48:13.000Z" itemprop="datePublished"> 发表于 2018-01-07</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p><a href="http://hihocoder.com/problemset/problem/1651" target="_blank" rel="external">http://hihocoder.com/problemset/problem/1651</a></p>
<h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>计数DP。令f(i)表示前i个珠子染色方案数，则如果第i个珠子和第i-1个珠子颜色不同，则第i个珠子有m-1种染色方案，若第i个珠子和第i-1个珠子颜色相同，则如果它们俩和第i-2个珠子颜色不同，染色方案有m-1个，如果i,i-1,i-2颜色相同，…以此类推，递推式为：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">dp[i]=dp[i-(k-1)]*(m-1)+dp[i-(k-2)]*(m-1)+...+dp[i-1]*(m-1)</div></pre></td></tr></table></figure></p>
<p>代码如下：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;functional&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;list&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cctype&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;fstream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;sstream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iomanip&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;time.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</div><div class="line"></div><div class="line"><span class="keyword">const</span> ll mod = <span class="number">1000000007</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1000</span> + <span class="number">5</span>;</div><div class="line"><span class="keyword">int</span> n, m, k;</div><div class="line">ll dp[maxn];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	<span class="comment">//freopen("4.txt", "r", stdin);</span></div><div class="line">	<span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m &gt;&gt; k;</div><div class="line">	dp[<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; k&amp;&amp;i &lt;= n; ++i)</div><div class="line">		dp[i] = (dp[i - <span class="number">1</span>] * m)%mod;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = k; i &lt;= n; ++i)</div><div class="line">	&#123;</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = k<span class="number">-1</span>; j &gt; <span class="number">0</span>; --j)</div><div class="line">		&#123;</div><div class="line">			dp[i] = (dp[i]+dp[i-j]*(m<span class="number">-1</span>)) % mod;</div><div class="line">		&#125;    </div><div class="line">	&#125;</div><div class="line">	<span class="built_in">cout</span> &lt;&lt; dp[n] &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/算法/">算法</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2018/01/06/1661 数组区间/" title="1661.数组区间" itemprop="url">1661.数组区间</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2018-01-06T13:48:13.000Z" itemprop="datePublished"> 发表于 2018-01-06</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>这种区间求和的问题一般都是用每个元素对最终答案的贡献来求解。<br>对于本题，数组中的每一个元素A[i]，我们可以计算以该元素为前k大的区间个数，具体思路是求出A[i]左边k个比A[i]大的数，右边k个比A[i]大的数。<br><strong>如何对于每一个Ai计算出左边(右边)距离Ai最近的并且比Ai大的K个数？</strong><br>首先对于最小的数，如果已经处理完它左右比它大的数，则它可以从数组中删去了，因为它不可能比任何其它数大，为了方便删除，需要用链表重新组织数组。<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;functional&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;unordered_map&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;list&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cctype&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;fstream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;sstream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iomanip&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;unordered_set&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bitset&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;time.h&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mem(a,x) memset(a,x,sizeof(a));</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> inf = <span class="number">0x3f3f3f3f</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">double</span> pi = <span class="built_in">acos</span>(<span class="number">-1.0</span>);</div><div class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-8</span>;</div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span> + <span class="number">5</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> N, K;</div><div class="line"></div><div class="line"><span class="keyword">int</span> A[maxn];</div><div class="line"><span class="keyword">struct</span> Node</div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> val;</div><div class="line">	Node *pre, *nxt;</div><div class="line">&#125;;</div><div class="line">Node LinkedList[maxn];</div><div class="line"></div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; GL[maxn], GR[maxn];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; K;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)<span class="built_in">cin</span> &gt;&gt; A[i];</div><div class="line">	LinkedList[<span class="number">0</span>].val = LinkedList[N + <span class="number">1</span>].val = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)&#123;</div><div class="line">		LinkedList[i].val = i;</div><div class="line">		LinkedList[i].pre = &amp;LinkedList[i - <span class="number">1</span>];</div><div class="line">		LinkedList[i].nxt = &amp;LinkedList[i + <span class="number">1</span>];</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">vector</span>&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; V;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)V.push_back(&#123;A[i],i&#125;);</div><div class="line">	sort(V.begin(),V.end());</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)&#123;</div><div class="line">		<span class="keyword">int</span> pos = V[i].second;</div><div class="line">		<span class="keyword">int</span> p = pos, q = pos,cnt=<span class="number">0</span>;</div><div class="line">		<span class="keyword">while</span> (LinkedList[p].val &amp;&amp; cnt&lt;=K)&#123;</div><div class="line">			GL[pos].push_back(LinkedList[p].val);</div><div class="line">			p = LinkedList[p].pre-&gt;val;</div><div class="line">			++cnt;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span>(cnt&lt;=K)GL[pos].push_back(<span class="number">0</span>);</div><div class="line">		cnt = <span class="number">0</span>;</div><div class="line">		<span class="keyword">while</span> (LinkedList[q].val &amp;&amp; cnt&lt;=K)&#123;</div><div class="line">			GR[pos].push_back(LinkedList[q].val);</div><div class="line">			q = LinkedList[q].nxt-&gt;val;</div><div class="line">			++cnt;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> (cnt &lt;= K)GR[pos].push_back(N + <span class="number">1</span>);</div><div class="line">		sort(GL[pos].begin(), GL[pos].end());</div><div class="line">		sort(GR[pos].begin(), GR[pos].end());</div><div class="line">		LinkedList[pos].pre-&gt;nxt = LinkedList[pos].nxt;</div><div class="line">		LinkedList[pos].nxt-&gt;pre = LinkedList[pos].pre;</div><div class="line">	&#125;</div><div class="line">	ll res = <span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)&#123;</div><div class="line">		<span class="keyword">int</span> p = GL[i].size(), q = GR[i].size();</div><div class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; p; ++j)&#123;</div><div class="line">			<span class="keyword">int</span> pos = min(K - (p - j), q - <span class="number">2</span>);</div><div class="line">			res += ll((GL[i][j] - GL[i][j - <span class="number">1</span>]))*ll((GR[i][pos + <span class="number">1</span>] - i))*ll(A[i]);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">cout</span> &lt;&lt; res &lt;&lt; <span class="built_in">endl</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="comment">//freopen("4.txt", "r", stdin);</span></div><div class="line">	<span class="keyword">int</span> T = <span class="number">1</span>;</div><div class="line">	<span class="comment">//cin &gt;&gt; T;</span></div><div class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= T; ++i)&#123;</div><div class="line"></div><div class="line">		solve();</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/算法/">算法</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/12/27/强化学习入门(三)/" title="强化学习入门(三)" itemprop="url">强化学习入门(三)</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2017-12-27T13:48:13.000Z" itemprop="datePublished"> 发表于 2017-12-27</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>书籍：机器学习 周志华<br>视频：<a href="https://www.youtube.com/watch?v=sGuiWX07sKw" target="_blank" rel="external">RL Course by David Silver</a><br>博客：<a href="http://www.algorithmdog.com/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0-%E9%A9%AC%E5%B0%94%E7%A7%91%E5%A4%AB%E5%86%B3%E7%AD%96%E8%BF%87%E7%A8%8B" target="_blank" rel="external">AlgorithmDog</a><br>知乎：<a href="https://zhuanlan.zhihu.com/p/26007538" target="_blank" rel="external">强化学习入门 第五讲 值函数逼近</a></p>
<h3 id="值函数近似"><a href="#值函数近似" class="headerlink" title="值函数近似"></a>值函数近似</h3><blockquote>
<p>前面已经讲了强化学习的基本方法：基于动态规划的方法，基于蒙特卡罗的方法和基于时间差分的方法。这些方法有一个基本的前提条件，那就是状态空间和动作空间是离散的，而且状态空间和动作空间不能太大。</p>
</blockquote>
<p><strong>强化学习的基本步骤：首先评估值函数，接着利用值函数改进当前策略，值函数的评估是关键。</strong>  </p>
<p>在表格型强化学习中，值函数对应着一张表。在值函数逼近方法中，值函数对应着一个逼近函数。值函数近似分为参数化近似和非参数化近似。  </p>
<p><strong>随机梯度近似</strong>：<br><img src="http://oc9b84kcd.bkt.clouddn.com/SGD.png" alt=""></p>
<h3 id="DQN"><a href="#DQN" class="headerlink" title="DQN"></a>DQN</h3><h4 id="Q-Learning"><a href="#Q-Learning" class="headerlink" title="Q-Learning"></a>Q-Learning</h4><p>Q-Learning是异策略时间差分方法，伪代码如图所示：<br><img src="http://oc9b84kcd.bkt.clouddn.com/Q.jpg" alt=""> </p>
<h4 id="Deep-Q-Learning"><a href="#Deep-Q-Learning" class="headerlink" title="Deep Q-Learning"></a>Deep Q-Learning</h4><p><img src="http://oc9b84kcd.bkt.clouddn.com/DQN2.png" alt=""><br>DQN对Q-learning的修改主要体现在以下三个方面：</p>
<ul>
<li><p>DQN利用深度卷积神经网络逼近值函数</p>
</li>
<li><p>DQN利用了经验回放对强化学习的学习过程进行训练</p>
</li>
<li><p>DQN独立设置了目标网络来单独处理时间差分算法中的TD偏差。</p>
<h5 id="1-DQN利用卷积神经网络逼近行为值函数"><a href="#1-DQN利用卷积神经网络逼近行为值函数" class="headerlink" title="1. DQN利用卷积神经网络逼近行为值函数"></a>1. DQN利用卷积神经网络逼近行为值函数</h5><p><img src="http://oc9b84kcd.bkt.clouddn.com/CNN.png" alt=""><br><strong>step1：首先，我们使用参数化逼近来近似行为值函数</strong>：</p>
<span>$Q(s,a;w)\approx Q^\prime(s,a)$</span><!-- Has MathJax -->
<p><strong>step2: 在Q值中使用均方误差来定义目标函数的loss function</strong>:</p>
<span>$L(w) = E[(\color{red}{\underbrace{r+\gamma\max_{a^\prime}Q(s^\prime,a^\prime,w)}_{Target}}\color{black}-Q(s,a,w))^2]$</span><!-- Has MathJax -->
<p><strong>step3: 计算参数ω关于loss function梯度</strong>：</p>
<span>$\frac{\partial  L(w)}{\partial w} =  E[(\color{red}{r+\gamma\max_{a^\prime}Q(s^\prime,a^\prime,w)}\color{black}-Q(s,a,w))\frac{\partial Q(s,a,w)}{\partial w}]$</span><!-- Has MathJax -->
<p><strong>step4: 使用SGD实现End-to-end的优化目标</strong>：<br>有了上面的梯度，可以从深度神经网络中进行计算，因此，就可以使用SGD 随机梯度下降来更新参数，从而得到最优的Q值。</p>
</li>
</ul>
<h5 id="2-DQN利用Expericence-Replay对强化学习过程进行训练"><a href="#2-DQN利用Expericence-Replay对强化学习过程进行训练" class="headerlink" title="2.DQN利用Expericence Replay对强化学习过程进行训练"></a>2.DQN利用Expericence Replay对强化学习过程进行训练</h5><p><strong>Experience Replay 的动机是: 解决神经网络不收敛</strong><br>1）深度神经网络作为有监督学习模型，要求数据满足独立同分布<br>2）但 Q Learning 算法得到的样本前后是有关系的。为了打破数据之间的关联性，Experience Replay 方法通过存储-采样的方法将这个关联性打破了。</p>
<h5 id="3-DQN设置了目标网络来单独处理时间差分算法中的TD偏差"><a href="#3-DQN设置了目标网络来单独处理时间差分算法中的TD偏差" class="headerlink" title="3.DQN设置了目标网络来单独处理时间差分算法中的TD偏差"></a>3.DQN设置了目标网络来单独处理时间差分算法中的TD偏差</h5><p><strong>进一步打破相关性</strong><br>以往用梯度下降算法：<br><span>$\omega_{t+1} =  \omega_{t}+\alpha[(\color{red}{r+\gamma\max_{a^\prime}Q(s^\prime,a^\prime,w)}\color{black}-Q(s,a,w))\frac{\partial Q(s,a,w)}{\partial w}$</span><!-- Has MathJax --><br>计算TD目标(红色部分)的动作值函数所用的网络参数ω，与梯度计算中要逼近的值函数所用的网络参数相同，这样就容易使得数据间存在关联性，训练不稳定。<br>为了解决这个问题，DeepMind在TD Target采用和训练目标不一样的参数ω-：<br><span>$\omega_{t+1} =  \omega_{t}+\alpha[(\color{red}{r+\gamma\max_{a^\prime}Q(s^\prime,a^\prime,w^-)}\color{black}-Q(s,a,w))\frac{\partial Q(s,a,w)}{\partial w}$</span><!-- Has MathJax --><br><a href="http://blog.csdn.net/songrotek/article/details/50951537" target="_blank" rel="external"><strong>参考代码</strong>：</a><br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> random</div><div class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</div><div class="line"></div><div class="line"><span class="comment">#超参数</span></div><div class="line">FRAME_PER_ACTION=<span class="number">1</span>    <span class="comment">#每个动作采几帧</span></div><div class="line">GAMMA=<span class="number">0.99</span>            <span class="comment">#折扣率</span></div><div class="line">OBSERVE=<span class="number">100.</span>          <span class="comment">#训练之前的观察时间</span></div><div class="line">EXPLORE=<span class="number">10000.</span>       <span class="comment">#试验数</span></div><div class="line">FINAL_EPSILON=<span class="number">0.0</span>     <span class="comment">#epsilon贪心最终参数</span></div><div class="line">INITIAL_EPSILON = <span class="number">0.5</span> <span class="comment">#epsilon贪心初始参数</span></div><div class="line">REPLAY_MEMORY=<span class="number">50000</span>   <span class="comment">#回放队列大小</span></div><div class="line">BATCH_SIZE=<span class="number">32</span>         <span class="comment">#minbatch大小</span></div><div class="line">UPDATE_TIME=<span class="number">100</span>       <span class="comment">#更新目标Q网络的时间间隔</span></div><div class="line">LEARNING_RATE=<span class="number">0.001</span>   <span class="comment">#学习率</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">BrainDQN</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self,actions)</span>:</span></div><div class="line">        <span class="comment">#初始化回放池</span></div><div class="line">        self.replayMemory = deque()</div><div class="line">        <span class="comment">#初始化相关参数</span></div><div class="line">        self.timeStep = <span class="number">0</span></div><div class="line">        self.epsilon=INITIAL_EPSILON</div><div class="line">        self.actions=actions</div><div class="line">        <span class="comment">#初始化Q网络</span></div><div class="line">        self.stateInput,self.QValue,self.W_conv1,self.b_conv1,self.W_conv2,self.b_conv2,self.W_conv3,self.b_conv3,self.W_fc1,self.b_fc1,self.W_fc2,self.b_fc2 = self.createQNetwork()</div><div class="line">        <span class="comment">#初始化目标Q网络并设置目标Q网络和Q网络参数一样，TD Target主要用于缓存Q网络参数值</span></div><div class="line">        self.stateInputT,self.QValueT,self.W_conv1T,self.b_conv1T,self.W_conv2T,self.b_conv2T,self.W_conv3T,self.b_conv3T,self.W_fc1T,self.b_fc1T,self.W_fc2T,self.b_fc2T = self.createQNetwork()</div><div class="line">        self.copyTargetQNetworkOperation = [self.W_conv1T.assign(self.W_conv1),self.b_conv1T.assign(self.b_conv1),self.W_conv2T.assign(self.W_conv2),self.b_conv2T.assign(self.b_conv2),self.W_conv3T.assign(self.W_conv3),self.b_conv3T.assign(self.b_conv3),self.W_fc1T.assign(self.W_fc1),self.b_fc1T.assign(self.b_fc1),self.W_fc2T.assign(self.W_fc2),self.b_fc2T.assign(self.b_fc2)]</div><div class="line">        self.createTrainingMethod()</div><div class="line">        <span class="comment"># saving and loading networks</span></div><div class="line">        self.saver = tf.train.Saver()</div><div class="line">        self.session = tf.InteractiveSession(config=tf.ConfigProto(log_device_placement=<span class="keyword">True</span>))</div><div class="line">        self.session.run(tf.initialize_all_variables())</div><div class="line">        checkpoint = tf.train.get_checkpoint_state(<span class="string">"saved_networks"</span>)</div><div class="line">        <span class="keyword">if</span> checkpoint <span class="keyword">and</span> checkpoint.model_checkpoint_path:</div><div class="line">            self.saver.restore(self.session, checkpoint.model_checkpoint_path)</div><div class="line">            <span class="keyword">print</span> (<span class="string">"Successfully loaded:"</span>, checkpoint.model_checkpoint_path)</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">print</span> (<span class="string">"Could not find old network weights"</span>)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">createQNetwork</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="comment">#三个卷积层</span></div><div class="line">        W_conv1=self.weight_variable([<span class="number">8</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">32</span>])</div><div class="line">        b_conv1=self.bias_variable([<span class="number">32</span>])</div><div class="line"></div><div class="line">        W_conv2=self.weight_variable([<span class="number">4</span>,<span class="number">4</span>,<span class="number">32</span>,<span class="number">64</span>])</div><div class="line">        b_conv2=self.bias_variable([<span class="number">64</span>])</div><div class="line"></div><div class="line">        W_conv3=self.weight_variable([<span class="number">3</span>,<span class="number">3</span>,<span class="number">64</span>,<span class="number">64</span>])</div><div class="line">        b_conv3=self.bias_variable([<span class="number">64</span>])</div><div class="line">        <span class="comment">#两个全连接层</span></div><div class="line">        W_fc1=self.weight_variable([<span class="number">1600</span>,<span class="number">512</span>])</div><div class="line">        b_fc1=self.bias_variable([<span class="number">512</span>])</div><div class="line"></div><div class="line">        W_fc2=self.weight_variable([<span class="number">512</span>,self.actions])</div><div class="line">        b_fc2=self.bias_variable([self.actions])</div><div class="line">        <span class="comment">#输入层</span></div><div class="line">        stateInput=tf.placeholder(tf.float32,[<span class="keyword">None</span>,<span class="number">80</span>,<span class="number">80</span>,<span class="number">4</span>])<span class="comment">#状态为4张80*80的照片</span></div><div class="line">        <span class="comment">#隐藏层</span></div><div class="line">        h_conv1=tf.nn.relu(self.conv2d(stateInput,W_conv1,<span class="number">4</span>)+b_conv1)</div><div class="line">        h_pool1=self.max_pool_2x2(h_conv1)</div><div class="line">        h_conv2 = tf.nn.relu(self.conv2d(h_pool1,W_conv2,<span class="number">2</span>) + b_conv2)</div><div class="line"></div><div class="line">        h_conv3 = tf.nn.relu(self.conv2d(h_conv2,W_conv3,<span class="number">1</span>) + b_conv3)</div><div class="line"></div><div class="line">        h_conv3_flat = tf.reshape(h_conv3,[<span class="number">-1</span>,<span class="number">1600</span>])</div><div class="line">        h_fc1 = tf.nn.relu(tf.matmul(h_conv3_flat,W_fc1) + b_fc1)</div><div class="line">        <span class="comment"># Q value 层</span></div><div class="line">        QValue = tf.matmul(h_fc1,W_fc2)+b_fc2</div><div class="line"></div><div class="line">        <span class="keyword">return</span> stateInput,QValue,W_conv1,b_conv1,W_conv2,b_conv2,W_conv3,b_conv3,W_fc1,b_fc1,W_fc2,b_fc2</div><div class="line"></div><div class="line">    <span class="comment">#缓存Q网络</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">copyTargetQNetwork</span><span class="params">(self)</span>:</span></div><div class="line">        self.session.run(self.copyTargetQNetworkOperation)</div><div class="line"></div><div class="line">    <span class="comment">#把观察的图片作为状态</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setInitState</span><span class="params">(self,observation)</span>:</span></div><div class="line">        self.currentState = np.stack((observation, observation, observation, observation), axis = <span class="number">2</span>)</div><div class="line">    <span class="comment">#记住输出是Q值，关键要计算出cost，里面关键是计算Q_action的值，即该state和action下的Q值。由于actionInput是</span></div><div class="line">    <span class="comment">#one hot vector的形式，因此tf.mul(self.QValue, self.actionInput)正好就是该action下的Q值。</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">createTrainingMethod</span><span class="params">(self)</span>:</span></div><div class="line">        self.actionInput=tf.placeholder(tf.float32,[<span class="keyword">None</span>,self.actions])</div><div class="line">        self.yInput=tf.placeholder(tf.float32,[<span class="keyword">None</span>])</div><div class="line">        Q_Action=tf.reduce_sum(tf.multiply(self.QValue,self.actionInput),reduction_indices=<span class="number">1</span>)</div><div class="line">        self.cost=tf.reduce_mean(tf.square(self.yInput-Q_Action))</div><div class="line">        self.trainStep=tf.train.AdamOptimizer(LEARNING_RATE).minimize(self.cost)</div><div class="line"></div><div class="line">    <span class="comment">#主要是从回放池里随机挑选一批数据，用TD Q网络求值，然后用于更新Q网络参数</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">trainQNetwork</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="comment">#step 1:从经验池里获取随机采样</span></div><div class="line">        minibatch=random.sample(self.replayMemory,BATCH_SIZE)</div><div class="line">        state_batch=[data[<span class="number">0</span>] <span class="keyword">for</span> data <span class="keyword">in</span> minibatch]</div><div class="line">        action_batch=[data[<span class="number">1</span>] <span class="keyword">for</span> data <span class="keyword">in</span> minibatch]</div><div class="line">        reward_batch=[data[<span class="number">2</span>] <span class="keyword">for</span> data <span class="keyword">in</span> minibatch]</div><div class="line">        nextState_batch=[data[<span class="number">3</span>]<span class="keyword">for</span> data <span class="keyword">in</span> minibatch]</div><div class="line">        <span class="comment">#step 2:计算y</span></div><div class="line">        y_batch=[]</div><div class="line">        QValue_batch=self.QValueT.eval(feed_dict=&#123;self.stateInputT:nextState_batch&#125;)</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,BATCH_SIZE):</div><div class="line">            terminal=minibatch[i][<span class="number">4</span>]</div><div class="line">            <span class="keyword">if</span> terminal:</div><div class="line">                y_batch.append(reward_batch[i])</div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                y_batch.append(reward_batch[i]+GAMMA*np.max(QValue_batch[i]))</div><div class="line">        self.trainStep.run(feed_dict=&#123;</div><div class="line">            self.yInput:y_batch,</div><div class="line">            self.actionInput:action_batch,</div><div class="line">            self.stateInput:state_batch</div><div class="line">            &#125;)</div><div class="line">        <span class="comment">#保存网络</span></div><div class="line">        <span class="keyword">if</span>(self.timeStep%<span class="number">10000</span>==<span class="number">0</span>):</div><div class="line">            self.saver.save(self.session,<span class="string">'saved_networks/'</span>+<span class="string">'network'</span>+<span class="string">'-dqn'</span>,global_step=self.timeStep)</div><div class="line">        <span class="comment">#更新TD Q网络</span></div><div class="line">        <span class="keyword">if</span> self.timeStep%UPDATE_TIME==<span class="number">0</span>:</div><div class="line">            self.copyTargetQNetwork()</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setPerception</span><span class="params">(self,nextObservation,action,reward,terminal)</span>:</span></div><div class="line">        newState=np.append(self.currentState[:,:,<span class="number">1</span>:],nextObservation,axis=<span class="number">2</span>)</div><div class="line">        self.replayMemory.append((self.currentState,action,reward,newState,terminal))</div><div class="line">        <span class="keyword">if</span> len(self.replayMemory)&gt;REPLAY_MEMORY:</div><div class="line">            self.replayMemory.popleft()</div><div class="line">        <span class="keyword">if</span> self.timeStep&gt;OBSERVE:</div><div class="line">            self.trainQNetwork()</div><div class="line">        <span class="comment">#打印信息</span></div><div class="line">        state=<span class="string">""</span></div><div class="line">        <span class="keyword">if</span> self.timeStep&lt;=OBSERVE:</div><div class="line">            state=<span class="string">"observe"</span></div><div class="line">        <span class="keyword">elif</span> self.timeStep&gt;OBSERVE <span class="keyword">and</span> self.timeStep&lt;=OBSERVE+EXPLORE:</div><div class="line">            state=<span class="string">"explore"</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            state=<span class="string">"train"</span></div><div class="line">        <span class="keyword">print</span> (<span class="string">"TIMESTEP"</span>, self.timeStep, <span class="string">"/ STATE"</span>, state, \</div><div class="line">            <span class="string">"/ EPSILON"</span>, self.epsilon)</div><div class="line">        self.currentState = newState</div><div class="line">        self.timeStep += <span class="number">1</span></div><div class="line"></div><div class="line">    <span class="comment">#采用epsilon贪心获取动作</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getAction</span><span class="params">(self)</span>:</span></div><div class="line">        QValue=self.QValue.eval(feed_dict=&#123;self.stateInput:[self.currentState]&#125;)[<span class="number">0</span>]<span class="comment">#所有动作的动作值函数</span></div><div class="line">        action=np.zeros(self.actions)</div><div class="line">        action_index=<span class="number">0</span></div><div class="line">        <span class="keyword">if</span> self.timeStep%FRAME_PER_ACTION==<span class="number">0</span>:</div><div class="line">            <span class="keyword">if</span>(random.random()&lt;=self.epsilon):</div><div class="line">                action_index=random.randrange(self.actions)</div><div class="line">                action[action_index]=<span class="number">1</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            action[<span class="number">0</span>]=<span class="number">1</span><span class="comment">#do noting</span></div><div class="line">        <span class="comment">#change episilon</span></div><div class="line">        <span class="keyword">if</span> self.epsilon&gt;FINAL_EPSILON <span class="keyword">and</span> self.timeStep&gt;OBSERVE:</div><div class="line">            self.epsilon -= (INITIAL_EPSILON - FINAL_EPSILON)/EXPLORE</div><div class="line">        <span class="keyword">return</span> action</div><div class="line">    <span class="comment">#初始化状态</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setInitState</span><span class="params">(self,observation)</span>:</span></div><div class="line">        self.currentState=np.stack((observation,observation,observation,observation),axis=<span class="number">2</span>)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">weight_variable</span><span class="params">(self,shape)</span>:</span></div><div class="line">        initial = tf.truncated_normal(shape, stddev = <span class="number">0.01</span>)</div><div class="line">        <span class="keyword">return</span> tf.Variable(initial)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bias_variable</span><span class="params">(self,shape)</span>:</span></div><div class="line">        initial = tf.constant(<span class="number">0.01</span>, shape = shape)</div><div class="line">        <span class="keyword">return</span> tf.Variable(initial)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">conv2d</span><span class="params">(self,x, W, stride)</span>:</span></div><div class="line">        <span class="keyword">return</span> tf.nn.conv2d(x, W, strides = [<span class="number">1</span>, stride, stride, <span class="number">1</span>], padding = <span class="string">"SAME"</span>)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">max_pool_2x2</span><span class="params">(self,x)</span>:</span></div><div class="line">        <span class="keyword">return</span> tf.nn.max_pool(x, ksize = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>], strides = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>], padding = <span class="string">"SAME"</span>)</div></pre></td></tr></table></figure></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/强化学习/">强化学习</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2017/12/23/强化学习入门(二)/" title="强化学习入门(二)" itemprop="url">强化学习入门(二)</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="洛绍川" target="_blank" itemprop="author">洛绍川</a>
		
  <p class="article-time">
    <time datetime="2017-12-23T13:48:13.000Z" itemprop="datePublished"> 发表于 2017-12-23</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>书籍：机器学习 周志华<br>视频：<a href="https://www.youtube.com/watch?v=sGuiWX07sKw" target="_blank" rel="external">RL Course by David Silver</a><br>博客：<a href="http://www.algorithmdog.com/%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0-%E9%A9%AC%E5%B0%94%E7%A7%91%E5%A4%AB%E5%86%B3%E7%AD%96%E8%BF%87%E7%A8%8B" target="_blank" rel="external">AlgorithmDog</a><br><a href="http://chenrudan.github.io/blog/2016/07/11/reinforcementlearninglesssion4.html" target="_blank" rel="external">David Silver强化学习公开课之四</a></p>
<h3 id="model-free-learning-免模型学习"><a href="#model-free-learning-免模型学习" class="headerlink" title="model-free learning 免模型学习"></a>model-free learning 免模型学习</h3><p>免模型学习：状态转移、奖励函数未知<br>策略评估：蒙特卡罗、时间差分<br>策略学习：Q-Learning、Sarsa<br>强化学习的方法就是<strong>先对当前策略进行策略评估，也就是说计算出当前策略所对应的值函数；然后，利用值函数改进当前策略。</strong><br>==<strong>强化学习的关键在于计算出值函数，而值函数的关键在于计算当前状态下获得回报的期望。</strong>==  </p>
<p>在有模型的强化学习中，我们知道马尔科夫决策过程的状态转移和奖励函数，因此值函数可以用动态规划求得。<br><span>$$v_\pi(s) = \mathbb E_\pi[G_t | S_t = s]

= \sum_{a} \pi(a|s) \left[ {R}_s^a + \gamma \sum_{s&apos;} { P}_{ss&apos;}^a v_\pi(s&apos;) \right]$$</span><!-- Has MathJax --><br><span>$$q_\pi(s, a) = \mathbb E_\pi[G_t | S_t = s, A_t = a]

= {R}_s^a + \gamma \sum_{s&apos;}{P}_{ss&apos;}^a \sum_{a&apos;}\pi(a&apos;|s&apos;)q_\pi(s&apos;, a&apos;)$$</span><!-- Has MathJax --><br><strong>所以无模型学习的关键是估计状态值函数和行为值函数中的期望。</strong></p>
<h4 id="蒙特卡罗学习"><a href="#蒙特卡罗学习" class="headerlink" title="蒙特卡罗学习"></a>蒙特卡罗学习</h4><p><strong>蒙特卡罗方法是利用经验平均代替随机变量的期望,即假设每个状态的值函数取值等于多次试验返回的回报的平均值。</strong><br>评估当前策略时，我们可以利用策略产生很多次试验，每次试验都是从任意的初始状态开始直到终止状态，比如一次试验(an<br>episode)为：<br><span>$S_1,A_1,R_2,&hellip;,S_k$</span><!-- Has MathJax --><br>计算一次试验中状态s处的折扣回报返回值为：<br><span>$G_t = R_{t+1}+\gamma R_{t+2}+&hellip;+\gamma^{k-1}R_{t+k}$</span><!-- Has MathJax --><br>我们只需要计算试验的次数和每次试验返回的回报求平均即可。令N(St)表示St访问的次数，Gt表示这次实验获得的回报,则值函数的更新如下：<br><span>$N(S_t)=N(S_t)+1$</span><!-- Has MathJax --><br><span>$V(S_t) = V(S_t)+\frac{1}{N(S_t)}(G_t-V(S_t))$</span><!-- Has MathJax --><br>在一些问题中，经常用一个平均访问次数alpha来代替N(St),即<br><span>$V(S_t) = V(S_t)+\alpha(G_t-V(S_t))$</span><!-- Has MathJax --></p>
<p><strong>探索</strong>：<br>为了获得较好的指函数的估计，需要充分探索每一个每一个动作可能到达的状态，也就是说在任意状态下，采用动作集中每个动作的概率都大于零。可以采用ε-soft选取动作：<br><img src="http://oc9b84kcd.bkt.clouddn.com/%E8%B4%AA%E5%BF%83.png" alt=""></p>
<p><strong>On-Policy &amp; Off-Policy</strong>:<br>同策略：用于采样和改进的策略是同一个策略π。<br>异策略：用于采样的是策略μ，来改进的是策略π。<br><strong>同策略蒙特卡罗</strong><br><img src="http://oc9b84kcd.bkt.clouddn.com/OnPolicy.png" alt="image"></p>
<p><strong>异策略蒙特卡罗</strong><br><img src="http://oc9b84kcd.bkt.clouddn.com/OffPolicy.png" alt="image"></p>
<h4 id="时间差分学习"><a href="#时间差分学习" class="headerlink" title="时间差分学习"></a>时间差分学习</h4><p>蒙特卡罗需要完成一个完整的采样轨迹后再更新策略的值估计，这样没有没有充分利用强化学习任务的MDP结构。时序差分学习则结合了动态规划与蒙特卡罗方法的思想，能做到更高效的无模型学习。MC算法总是从当前状态出发，一直走到终止状态再更新当前状态的值函数，而TD算法可以从当前状态出发走n步再更新当前状态的值函数，特别的，走一步就更新的即TD(0)。TD(0)的值函数更新公式如下：<br><span>$V(S_t) = V(S_t)+\alpha(R_{t+1}+\gamma V(S_{t+1})-V(S_t))$</span><!-- Has MathJax --><br><span>$Q(S_t, A_t) = Q(S_t, A_t) + \alpha(R_{t+1} + \gamma Q(S_{t+1}, A&apos;) - Q(S_t, A_t)$</span><!-- Has MathJax --><br>TD(0)是指在某个状态s下执行某个动作后转移到下一个状态s′s′时，估计s′的return再更新s，假如s之后执行两次动作转移到s′′时再反回来更新s的值函数，那么就是另一种形式，从而根据step的长度n可以扩展TD到不同的形式，当step长度到达当前episode终点时就变成了MC。从而得到统一公式如下:<br><span>$G_t^{(n)} = R_{t+1} + \gamma R_{t+2} + &hellip; + \gamma ^{n-1}R_{t+n}+\gamma ^nV(S_{t+n})$</span><!-- Has MathJax --><br><span>$V(S_t) = V(S_t) + \alpha(G_t^{(n)} - V(S_t))$</span><!-- Has MathJax --><br><strong>On-Policy Sarsa算法</strong>：<br>执行策略和改进的策略都是ε-贪婪策略。<br><img src="http://oc9b84kcd.bkt.clouddn.com/Sarsa.png" alt=""><br><strong>Off-Policy Q-Learning算法</strong>：<br>执行策略为ε-贪婪策略，改进策略为贪婪策略。<br><img src="http://oc9b84kcd.bkt.clouddn.com/QLearning.png" alt=""></p>
<h4 id="蒙特卡罗-vs-时间差分"><a href="#蒙特卡罗-vs-时间差分" class="headerlink" title="蒙特卡罗 vs 时间差分"></a>蒙特卡罗 vs 时间差分</h4><p><img src="http://oc9b84kcd.bkt.clouddn.com/MC&amp;TD.png" alt=""></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/强化学习/">强化学习</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>







  <nav id="page-nav" class="clearfix">
    <a class="extend prev" rel="prev" href="/page/2/"><span></span>Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/4/">Next<span></span></a>
  </nav>

</div>
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  


  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/PAT/" title="PAT">PAT<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Parallel-Studio/" title="Parallel Studio">Parallel Studio<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/Python/" title="Python">Python<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/hihocoder/" title="hihocoder">hihocoder<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/生活随笔/" title="生活随笔">生活随笔<sup>1</sup></a></li>
		  
		
		  
			<li><a href="/categories/算法/" title="算法">算法<sup>3</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/算法/" title="算法">算法<sup>31</sup></a></li>
			
		
			
				<li><a href="/tags/算法-leetcode/" title="算法 leetcode">算法 leetcode<sup>9</sup></a></li>
			
		
			
				<li><a href="/tags/算法-动态规划/" title="算法 动态规划">算法 动态规划<sup>8</sup></a></li>
			
		
			
				<li><a href="/tags/Python/" title="Python">Python<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/Kickstart-Google/" title="Kickstart Google">Kickstart Google<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/笔试/" title="笔试">笔试<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/强化学习/" title="强化学习">强化学习<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/MNIST-TensorFlow/" title="MNIST TensorFlow">MNIST TensorFlow<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/深度学习-TensorFlow/" title="深度学习 TensorFlow">深度学习 TensorFlow<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Manacher算法/" title="Manacher算法">Manacher算法<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/正则表达式/" title="正则表达式">正则表达式<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Trie树/" title="Trie树">Trie树<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/Parallel-Studio/" title="Parallel Studio">Parallel Studio<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/ICC/" title="ICC">ICC<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/MKL/" title="MKL">MKL<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/KMP算法/" title="KMP算法">KMP算法<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/母函数法/" title="母函数法">母函数法<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/hihocoder-分治/" title="hihocoder 分治">hihocoder 分治<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/DFA/" title="DFA">DFA<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/matplotlib/" title="matplotlib">matplotlib<sup>1</sup></a></li>
			
		
		</ul>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	
	<div class="social-font" class="clearfix">
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2018 
		
		<a href="/about" target="_blank" title="洛绍川">洛绍川</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>










<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->





<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End --><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->

  </body>
 </html>
